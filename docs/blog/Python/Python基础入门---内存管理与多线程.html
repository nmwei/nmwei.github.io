<!DOCTYPE html><html lang="zh-cn" class="__variable_bc0dcf scroll-smooth"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" href="/_next/static/media/7cba1811e3c25a15-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" as="image" href="https://upload-images.jianshu.io/upload_images/4989175-8894d3b0e01adaa9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"/><link rel="preload" as="image" href="https://upload-images.jianshu.io/upload_images/4989175-ea3ff3e091d9504b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"/><link rel="stylesheet" href="/_next/static/css/f71128b9ac16cc11.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/5fa3e5bae12b17db.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/206c8cd9f1135cc1.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-af24fb31267d6e11.js"/><script src="/_next/static/chunks/4bd1b696-5100ffb4d6775e5e.js" async=""></script><script src="/_next/static/chunks/684-4bcfa8f1cbca4f10.js" async=""></script><script src="/_next/static/chunks/main-app-b9fbee67b30e93b9.js" async=""></script><script src="/_next/static/chunks/c16f53c3-5b47b7f1ae12d8f6.js" async=""></script><script src="/_next/static/chunks/874-7cca39d2e0ddd8b8.js" async=""></script><script src="/_next/static/chunks/430-27ea613f983ffbaf.js" async=""></script><script src="/_next/static/chunks/app/layout-4f2fc603b9b897e8.js" async=""></script><script src="/_next/static/chunks/63-2b4206848ffc60fb.js" async=""></script><script src="/_next/static/chunks/app/blog/%5B...slug%5D/page-28d33eed3f173442.js" async=""></script><link rel="preload" href="https://analytics.umami.is/script.js" as="script"/><meta name="next-size-adjust" content=""/><link rel="apple-touch-icon" sizes="76x76" href="/static/favicons/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/static/favicons/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/static/favicons/favicon-16x16.png"/><link rel="manifest" href="/static/favicons/site.webmanifest"/><link rel="mask-icon" href="/static/favicons/safari-pinned-tab.svg" color="#5bbad5"/><meta name="msapplication-TileColor" content="#000000"/><meta name="theme-color" media="(prefers-color-scheme: light)" content="#fff"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#000"/><link rel="alternate" type="application/rss+xml" href="/feed.xml"/><title>Python基础入门---内存管理与多线程 | 我的博客</title><meta name="description" content="Python基础入门---内存管理与多线程相关文章"/><meta name="robots" content="index, follow"/><meta name="googlebot" content="index, follow, max-video-preview:-1, max-image-preview:large, max-snippet:-1"/><link rel="canonical" href="https://nmwei.github.io/blog/Python/Python%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8---%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86%E4%B8%8E%E5%A4%9A%E7%BA%BF%E7%A8%8B"/><link rel="alternate" type="application/rss+xml" href="https://nmwei.github.io/feed.xml"/><meta property="og:title" content="Python基础入门---内存管理与多线程"/><meta property="og:description" content="Python基础入门---内存管理与多线程相关文章"/><meta property="og:url" content="https://nmwei.github.io/blog/Python/Python%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8---%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86%E4%B8%8E%E5%A4%9A%E7%BA%BF%E7%A8%8B"/><meta property="og:site_name" content="我的博客"/><meta property="og:locale" content="en_US"/><meta property="og:image" content="https://nmwei.github.io/static/images/python.jpg"/><meta property="og:type" content="article"/><meta property="article:published_time" content="2019-10-17T00:00:00.000Z"/><meta property="article:modified_time" content="2019-10-17T00:00:00.000Z"/><meta property="article:author" content="倪梦威"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:title" content="Python基础入门---内存管理与多线程"/><meta name="twitter:description" content="Python基础入门---内存管理与多线程相关文章"/><meta name="twitter:image" content="https://nmwei.github.io/static/images/python.jpg"/><script src="/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule=""></script></head><body class="bg-white pl-[calc(100vw-100%)] text-black antialiased dark:bg-gray-950 dark:text-white"><script>((e,t,r,n,o,i,a,l)=>{let u=document.documentElement,s=["light","dark"];function c(t){var r;(Array.isArray(e)?e:[e]).forEach(e=>{let r="class"===e,n=r&&i?o.map(e=>i[e]||e):o;r?(u.classList.remove(...n),u.classList.add(i&&i[t]?i[t]:t)):u.setAttribute(e,t)}),r=t,l&&s.includes(r)&&(u.style.colorScheme=r)}if(n)c(n);else try{let e=localStorage.getItem(t)||r,n=a&&"system"===e?window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":e;c(n)}catch(e){}})("class","theme","system",null,["light","dark"],null,true,true)</script><section class="mx-auto max-w-3xl px-4 sm:px-6 xl:max-w-5xl xl:px-0"><header class="flex items-center w-full bg-white dark:bg-gray-950 justify-between py-10"><a class="break-words" aria-label="我的博客" href="/"><div class="flex items-center justify-between"><div class="mr-3"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="53.87" height="43.61" viewBox="344.564 330.278 111.737 91.218"><defs><linearGradient id="logo_svg__b" x1="420.97" x2="420.97" y1="331.28" y2="418.5" gradientUnits="userSpaceOnUse"><stop offset="0%" style="stop-color:#06b6d4;stop-opacity:1"></stop><stop offset="100%" style="stop-color:#67e8f9;stop-opacity:1"></stop></linearGradient><linearGradient id="logo_svg__d" x1="377.89" x2="377.89" y1="331.28" y2="418.5" gradientUnits="userSpaceOnUse"><stop offset="0%" style="stop-color:#06b6d4;stop-opacity:1"></stop><stop offset="100%" style="stop-color:#67e8f9;stop-opacity:1"></stop></linearGradient><path id="logo_svg__a" d="M453.3 331.28v28.57l-64.66 58.65v-30.08z"></path><path id="logo_svg__c" d="M410.23 331.28v28.57l-64.67 58.65v-30.08z"></path></defs><use xlink:href="#logo_svg__a" fill="url(#logo_svg__b)"></use><use xlink:href="#logo_svg__c" fill="url(#logo_svg__d)"></use></svg></div><div class="hidden h-6 text-2xl font-semibold sm:block">我的博客</div></div></a><div class="flex items-center space-x-4 leading-5 sm:-mr-6 sm:space-x-6"><div class="no-scrollbar hidden max-w-40 items-center gap-x-4 overflow-x-auto sm:flex md:max-w-72 lg:max-w-96"><a class="hover:text-primary-500 dark:hover:text-primary-400 m-1 font-medium text-gray-900 dark:text-gray-100" href="/blog">博客</a><a class="hover:text-primary-500 dark:hover:text-primary-400 m-1 font-medium text-gray-900 dark:text-gray-100" href="/tags">标签</a><a class="hover:text-primary-500 dark:hover:text-primary-400 m-1 font-medium text-gray-900 dark:text-gray-100" href="/projects">项目</a><a class="hover:text-primary-500 dark:hover:text-primary-400 m-1 font-medium text-gray-900 dark:text-gray-100" href="/about">关于</a></div><button aria-label="Search"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="hover:text-primary-500 dark:hover:text-primary-400 h-6 w-6 text-gray-900 dark:text-gray-100"><path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"></path></svg></button><div class="flex items-center"><div class="relative inline-block text-left" data-headlessui-state=""><div class="hover:text-primary-500 dark:hover:text-primary-400 flex items-center justify-center"><button aria-label="Theme switcher" id="headlessui-menu-button-«Rtpkqlb»" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state=""><svg class="h-6 w-6"></svg></button></div></div></div><button aria-label="Toggle Menu" class="sm:hidden"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="hover:text-primary-500 dark:hover:text-primary-400 h-8 w-8 text-gray-900 dark:text-gray-100"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg></button><span hidden="" style="position:fixed;top:1px;left:1px;width:1px;height:0;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border-width:0;display:none"></span></div></header><main class="mb-auto"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","headline":"Python基础入门---内存管理与多线程","datePublished":"2019-10-17T00:00:00.000Z","dateModified":"2019-10-17T00:00:00.000Z","description":"Python基础入门---内存管理与多线程相关文章","image":"/static/images/python.jpg","url":"https://nmwei.github.io/blog/Python/Python基础入门---内存管理与多线程","author":[{"@type":"Person","name":"倪梦威"}]}</script><section class="mx-auto max-w-3xl px-4 sm:px-6 xl:max-w-5xl xl:px-0"><div class="fixed right-8 bottom-8 hidden flex-col gap-3 md:hidden"><button aria-label="Scroll To Comment" class="rounded-full bg-gray-200 p-2 text-gray-500 transition-all hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-400 dark:hover:bg-gray-600"><svg class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M18 10c0 3.866-3.582 7-8 7a8.841 8.841 0 01-4.083-.98L2 17l1.338-3.123C2.493 12.767 2 11.434 2 10c0-3.866 3.582-7 8-7s8 3.134 8 7zM7 9H5v2h2V9zm8 0h-2v2h2V9zM9 9h2v2H9V9z" clip-rule="evenodd"></path></svg></button><button aria-label="Scroll To Top" class="rounded-full bg-gray-200 p-2 text-gray-500 transition-all hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-400 dark:hover:bg-gray-600"><svg class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M3.293 9.707a1 1 0 010-1.414l6-6a1 1 0 011.414 0l6 6a1 1 0 01-1.414 1.414L11 5.414V17a1 1 0 11-2 0V5.414L4.707 9.707a1 1 0 01-1.414 0z" clip-rule="evenodd"></path></svg></button></div><article><div class="xl:divide-y xl:divide-gray-200 xl:dark:divide-gray-700"><header class="pt-6 xl:pb-6"><div class="space-y-1 text-center"><dl class="space-y-10"><div><dt class="sr-only">Published on</dt><dd class="text-base leading-6 font-medium text-gray-500 dark:text-gray-400"><time dateTime="2019-10-17T00:00:00.000Z">2019年10月17日星期四</time></dd></div></dl><div><h1 class="text-3xl leading-9 font-extrabold tracking-tight text-gray-900 sm:text-4xl sm:leading-10 md:text-5xl md:leading-14 dark:text-gray-100">Python基础入门---内存管理与多线程</h1></div></div></header><div class="grid-rows-[auto_1fr] divide-y divide-gray-200 pb-8 xl:grid xl:grid-cols-4 xl:gap-x-6 xl:divide-y-0 dark:divide-gray-700"><dl class="pt-6 pb-10 xl:border-b xl:border-gray-200 xl:pt-11 xl:dark:border-gray-700"><dt class="sr-only">Authors</dt><dd><ul class="flex flex-wrap justify-center gap-4 sm:space-x-12 xl:block xl:space-y-8 xl:space-x-0"><li class="flex items-center space-x-2"><img alt="avatar" loading="lazy" width="38" height="38" decoding="async" data-nimg="1" class="h-10 w-10 rounded-full" style="color:transparent" src="/static/images/avatar.png"/><dl class="text-sm leading-5 font-medium whitespace-nowrap"><dt class="sr-only">Name</dt><dd class="text-gray-900 dark:text-gray-100">倪梦威</dd><dt class="sr-only">Twitter</dt><dd></dd></dl></li></ul></dd></dl><div class="divide-y divide-gray-200 xl:col-span-3 xl:row-span-2 xl:pb-0 dark:divide-gray-700"><div class="prose dark:prose-invert max-w-none pt-10 pb-8"><h1 class="content-header" id="1-内存管理机制"><a class="break-words" href="#1-内存管理机制" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>1. 内存管理机制</h1><h2 class="content-header" id="11-介绍"><a class="break-words" href="#11-介绍" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>1.1 介绍</h2><ol><li>概要 赋值语句内存分析 垃圾回收机制 内存管理机制</li><li>目标 掌握赋值语句内存分析方法 掌握<code>id()</code>和<code>is</code>的使用 了解<code>Python</code>的垃圾回收机制 了解<code>Python</code>的内存管理机制</li><li>内存与硬盘 内存是电脑的数据存储设备之一，其特点为容量较小，但数据传送速度较快，用以弥补硬盘虽然容量大但传送速度慢的缺点。</li></ol><h2 class="content-header" id="12-内存管理机制"><a class="break-words" href="#12-内存管理机制" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>1.2 内存管理机制</h2><ol><li><code>is</code>、<code>id()</code>和<code>==</code> <code>a is b</code>等价于<code>id(a) == id(b)</code>，比较的是<code>id</code>(内存标识)是否相同。 <code>a == b</code>比较的是<code>value</code>(值)是否相同。</li></ol><div class="relative"><pre><code class="language-js code-highlight"><span class="code-line">a1 <span class="token operator">=</span> <span class="token number">5</span>
</span><span class="code-line">a2 <span class="token operator">=</span> <span class="token number">5</span>
</span><span class="code-line"><span class="token function">print</span><span class="token punctuation">(</span><span class="token function">id</span><span class="token punctuation">(</span>a1<span class="token punctuation">)</span><span class="token punctuation">)</span>  # <span class="token number">4313714912</span>
</span><span class="code-line"><span class="token function">print</span><span class="token punctuation">(</span><span class="token function">id</span><span class="token punctuation">(</span>a1<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token function">id</span><span class="token punctuation">(</span>a2<span class="token punctuation">)</span><span class="token punctuation">,</span> a1 is a2<span class="token punctuation">)</span>  # <span class="token maybe-class-name">True</span> <span class="token maybe-class-name">True</span>
</span><span class="code-line">
</span><span class="code-line">b1 <span class="token operator">=</span> <span class="token string">&#x27;abc&#x27;</span>
</span><span class="code-line">b2 <span class="token operator">=</span> <span class="token string">&#x27;abc&#x27;</span>
</span><span class="code-line"><span class="token function">print</span><span class="token punctuation">(</span>b1 <span class="token operator">==</span> b2<span class="token punctuation">,</span> b1 is b2<span class="token punctuation">)</span>  # <span class="token maybe-class-name">True</span> <span class="token maybe-class-name">True</span>
</span><span class="code-line">
</span><span class="code-line">c1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
</span><span class="code-line">c2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
</span><span class="code-line"><span class="token function">print</span><span class="token punctuation">(</span>c1 <span class="token operator">==</span> c2<span class="token punctuation">,</span> c1 is c2<span class="token punctuation">)</span>  # <span class="token maybe-class-name">True</span> <span class="token maybe-class-name">False</span>
</span><span class="code-line">
</span><span class="code-line">d1 <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token property string-property">&#x27;a&#x27;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">}</span>
</span><span class="code-line">d2 <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token property string-property">&#x27;a&#x27;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">}</span>
</span><span class="code-line"><span class="token function">print</span><span class="token punctuation">(</span>d1 <span class="token operator">==</span> d2<span class="token punctuation">,</span> d1 is d2<span class="token punctuation">)</span>  # <span class="token maybe-class-name">True</span> <span class="token maybe-class-name">False</span>
</span></code></pre></div><ol start="2"><li>内存管理示例</li></ol><div class="relative"><pre><code class="language-js code-highlight"><span class="code-line">def <span class="token function">extend_list</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> list<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">:</span>
</span><span class="code-line">    list<span class="token punctuation">.</span><span class="token function property-access method">append</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token keyword control-flow">return</span> list
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line">l1 <span class="token operator">=</span> <span class="token function">extend_list</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
</span><span class="code-line">l2 <span class="token operator">=</span> <span class="token function">extend_list</span><span class="token punctuation">(</span><span class="token number">123</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</span><span class="code-line">l3 <span class="token operator">=</span> <span class="token function">extend_list</span><span class="token punctuation">(</span><span class="token string">&#x27;a&#x27;</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token function">print</span><span class="token punctuation">(</span>l1<span class="token punctuation">)</span>  # <span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token string">&#x27;a&#x27;</span><span class="token punctuation">]</span>
</span><span class="code-line"><span class="token function">print</span><span class="token punctuation">(</span>l2<span class="token punctuation">)</span>  # <span class="token punctuation">[</span><span class="token number">123</span><span class="token punctuation">]</span>
</span><span class="code-line"><span class="token function">print</span><span class="token punctuation">(</span>l3<span class="token punctuation">)</span>  # <span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token string">&#x27;a&#x27;</span><span class="token punctuation">]</span>
</span></code></pre></div><ol start="3"><li>垃圾回收机制 以引用计数为主，分代收集为辅。</li></ol><div class="relative"><pre><code class="language-js code-highlight"><span class="code-line"><span class="token keyword">class</span> <span class="token class-name">Cat</span><span class="token punctuation">(</span>object<span class="token punctuation">)</span><span class="token operator">:</span>
</span><span class="code-line">    def <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token operator">:</span>
</span><span class="code-line">        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&#x27;{} init&#x27;</span><span class="token punctuation">.</span><span class="token function property-access method">format</span><span class="token punctuation">(</span><span class="token function">id</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">    def <span class="token function">__del__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token operator">:</span>
</span><span class="code-line">        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&#x27;{} del&#x27;</span><span class="token punctuation">.</span><span class="token function property-access method">format</span><span class="token punctuation">(</span><span class="token function">id</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword control-flow">while</span> <span class="token property literal-property">True</span><span class="token operator">:</span>
</span><span class="code-line">    <span class="token string">&quot;&quot;</span><span class="token string">&quot; 自动回收内存 &quot;</span><span class="token string">&quot;&quot;</span>
</span><span class="code-line">    c1 <span class="token operator">=</span> <span class="token function"><span class="token maybe-class-name">Cat</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line">l <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
</span><span class="code-line"><span class="token keyword control-flow">while</span> <span class="token property literal-property">True</span><span class="token operator">:</span>
</span><span class="code-line">    <span class="token string">&quot;&quot;</span><span class="token string">&quot; 一直被引用，内存不会释放 &quot;</span><span class="token string">&quot;&quot;</span>
</span><span class="code-line">    c1 <span class="token operator">=</span> <span class="token function"><span class="token maybe-class-name">Cat</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">    l<span class="token punctuation">.</span><span class="token function property-access method">append</span><span class="token punctuation">(</span>c1<span class="token punctuation">)</span>
</span></code></pre></div><p>注意：在引用计数垃圾回收机制中，循环引用会导致内存泄漏。 4. 引用计数 每个对象都存在指向该对象的引用计数。 查看某个对象的引用计数：<code>sys.getrefcount()</code> 删除某个引用： <code>del</code></p><div class="relative"><pre><code class="language-js code-highlight"><span class="code-line"><span class="token keyword module">import</span> sys
</span><span class="code-line">
</span><span class="code-line"># 基本数据类型
</span><span class="code-line">i <span class="token operator">=</span> <span class="token number">1</span>
</span><span class="code-line"><span class="token function">print</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span><span class="token function property-access method">getrefcount</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span>  # <span class="token number">181</span>
</span><span class="code-line">i1 <span class="token operator">=</span> <span class="token number">1</span>
</span><span class="code-line">i2 <span class="token operator">=</span> i1
</span><span class="code-line"><span class="token function">print</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span><span class="token function property-access method">getrefcount</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span>  # <span class="token number">183</span>
</span><span class="code-line">del i1
</span><span class="code-line"><span class="token function">print</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span><span class="token function property-access method">getrefcount</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span>  # <span class="token number">182</span>
</span><span class="code-line">
</span><span class="code-line"># 引用数据类型
</span><span class="code-line">l <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
</span><span class="code-line"><span class="token function">print</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span><span class="token function property-access method">getrefcount</span><span class="token punctuation">(</span>l<span class="token punctuation">)</span><span class="token punctuation">)</span>   # <span class="token number">2</span>
</span><span class="code-line">l1 <span class="token operator">=</span> l
</span><span class="code-line">l2 <span class="token operator">=</span> l1
</span><span class="code-line"><span class="token function">print</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span><span class="token function property-access method">getrefcount</span><span class="token punctuation">(</span>l<span class="token punctuation">)</span><span class="token punctuation">)</span>  # <span class="token number">4</span>
</span><span class="code-line">del l2
</span><span class="code-line"><span class="token function">print</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span><span class="token function property-access method">getrefcount</span><span class="token punctuation">(</span>l<span class="token punctuation">)</span><span class="token punctuation">)</span>  # <span class="token number">3</span>
</span></code></pre></div><ol start="5"><li>分代收集 <code>Python</code>将所有的对象分为<code>0</code>，<code>1</code>，<code>2</code>三代。 所有新建对象都是<code>0</code>代对象。 当某一代对象经历过垃圾回收，依然存活，那么它就被归入下一代对象。</li><li>垃圾回收时机 当<code>Python</code>运行时，会记录其中分配对象(<code>object allocation</code>)和取消分配对象(<code>object deallocation</code>)的次数。当两者的差值高于某一个阈值时，垃圾回收才会启动。 查看阈值：<code>gc.get_threshold()</code></li></ol><div class="relative"><pre><code class="language-js code-highlight"><span class="code-line"><span class="token keyword module">import</span> gc
</span><span class="code-line">
</span><span class="code-line"><span class="token function">print</span><span class="token punctuation">(</span>gc<span class="token punctuation">.</span><span class="token function property-access method">get_threshold</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  # <span class="token punctuation">(</span><span class="token number">700</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span> 依次表示第<span class="token number">0</span>、<span class="token number">1</span>、<span class="token number">2</span>代垃圾回收阈值
</span></code></pre></div><ol start="7"><li>手动回收 <code>gc.collect()</code>手动回收。 <code>objgraph</code>模块中的<code>count()</code>可以记录当前类产生的未回收实例对象个数。</li></ol><div class="relative"><pre><code class="language-js code-highlight"><span class="code-line"><span class="token keyword">class</span> <span class="token class-name">Person</span><span class="token punctuation">(</span>object<span class="token punctuation">)</span><span class="token operator">:</span>
</span><span class="code-line">    pass
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">class</span> <span class="token class-name">Cat</span><span class="token punctuation">(</span>object<span class="token punctuation">)</span><span class="token operator">:</span>
</span><span class="code-line">    pass
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line">p <span class="token operator">=</span> <span class="token function"><span class="token maybe-class-name">Person</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">c <span class="token operator">=</span> <span class="token function"><span class="token maybe-class-name">Cat</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">p<span class="token punctuation">.</span><span class="token property-access">pet</span> <span class="token operator">=</span> c
</span><span class="code-line">c<span class="token punctuation">.</span><span class="token property-access">master</span> <span class="token operator">=</span> p
</span><span class="code-line"><span class="token function">print</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span><span class="token function property-access method">getrefcount</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">)</span>  # <span class="token number">3</span>
</span><span class="code-line"><span class="token function">print</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span><span class="token function property-access method">getrefcount</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">)</span>  # <span class="token number">3</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token function">print</span><span class="token punctuation">(</span>objgraph<span class="token punctuation">.</span><span class="token function property-access method">count</span><span class="token punctuation">(</span><span class="token string">&#x27;Person&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  # <span class="token number">1</span>
</span><span class="code-line"><span class="token function">print</span><span class="token punctuation">(</span>objgraph<span class="token punctuation">.</span><span class="token function property-access method">count</span><span class="token punctuation">(</span><span class="token string">&#x27;Cat&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  # <span class="token number">1</span>
</span><span class="code-line">
</span><span class="code-line">del p
</span><span class="code-line">del c
</span><span class="code-line">gc<span class="token punctuation">.</span><span class="token function property-access method">collect</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  # p与c循环引用。如果不使用del，则无法回收。
</span><span class="code-line"><span class="token function">print</span><span class="token punctuation">(</span>objgraph<span class="token punctuation">.</span><span class="token function property-access method">count</span><span class="token punctuation">(</span><span class="token string">&#x27;Person&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  # <span class="token number">0</span>
</span><span class="code-line"><span class="token function">print</span><span class="token punctuation">(</span>objgraph<span class="token punctuation">.</span><span class="token function property-access method">count</span><span class="token punctuation">(</span><span class="token string">&#x27;Cat&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  # <span class="token number">0</span>
</span></code></pre></div><ol start="8"><li>内存池(<code>memory pool</code>)机制 当创建大量小内存对象时，频繁调用<code>new / malloc</code>会导致大量内存碎片，效率降低。内存池就是预先在内存中申请一定数量的、大小相等的内存块留作备用，当有新的内存需求时，就先从内存池中分配内存给这个需求，不够了再申请新的内存。这样做可以减少内存碎片，提高效率。 <code>Python3</code>中的内存管理机制——<code>Pymalloc</code> 针对小对象(<code>&lt;=512bytes</code>)，<code>pymalloc</code>会在内存池中申请内存空间。 当内存<code>&gt;512bytes</code>时，则使用<code>PyMen_RawMalloc()</code>和<code>PyMem_RawRealloc()</code>来申请新的内存空间。 注释：<code>1 Byte = 8 Bits</code>(即<code>1B = 8b</code>)</li></ol><h2 class="content-header" id="13-总结"><a class="break-words" href="#13-总结" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>1.3 总结</h2><ol><li>赋值语句内存分析 使用<code>id()</code>方法访问内存地址 使用<code>is</code>比较内存地址是否相同</li><li>垃圾回收机制 引用计数为主，分代收集为辅 引用计数的缺陷是循环引用问题</li><li>内存管理机制 内存池(<code>memory pool</code>)机制</li></ol><h1 class="content-header" id="2-线程进程协程"><a class="break-words" href="#2-线程进程协程" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>2. 线程、进程、协程</h1><h2 class="content-header" id="21-介绍"><a class="break-words" href="#21-介绍" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>2.1 介绍</h2><ol><li>章节概要 进程、线程与并发 对多核的利用 实现一个线程 线程之间的通信 线程的调度和优化</li><li>使用场景 快速高效的爬虫程序 多用户同时访问<code>Web</code>服务 电商秒杀、抢购活动 物联网传感器监控服务</li></ol><h2 class="content-header" id="22-线程"><a class="break-words" href="#22-线程" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>2.2 线程</h2><ol><li>线程介绍 在同一个进程下执行，并共享相同的上下文。 一个进程中的各个线程与主线程共享<strong>同一片</strong>数据空间。 线程包括开始、执行顺序和结束三部分。 线程可以被强占(中断)和临时挂起(睡眠)——让步</li><li>多核的利用 单核<code>CPU</code>系统中，不存在真正的并发。 <code>GIL</code>全局解释器锁 - 强制在任何时候只有一个线程可以执行<code>Python</code>代码。 <code>I/O</code>密集型应用与<code>CPU</code>密集型应用。</li><li><code>GIL</code>执行顺序 (1) 设置<code>GIL</code> (2) 切换进一个线程去执行 (3) 执行下面操作之一 指定数量的字节码指令； 线程主动让出控制权(可以调用<code>time.sleep(0)</code>来完成)。 (4) 把线程设置回睡眠状态(切换出线程) (5) 解锁<code>GIL</code> (6) 重复上述步骤</li><li><code>threading</code>模块对象 <img alt="threading模块对象" src="https://upload-images.jianshu.io/upload_images/4989175-8894d3b0e01adaa9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"/></li><li><code>Thread</code>对象方法 <img alt="Thread对象方法" src="https://upload-images.jianshu.io/upload_images/4989175-ea3ff3e091d9504b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"/></li><li>线程实现(面向过程)</li></ol><div class="relative"><pre><code class="language-js code-highlight"><span class="code-line"><span class="token keyword module">import</span> threading
</span><span class="code-line"><span class="token keyword module">import</span> time
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line">def <span class="token function">loop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span>
</span><span class="code-line">    <span class="token string">&quot;&quot;</span><span class="token string">&quot; 新的线程执行的代码  &quot;</span><span class="token string">&quot;&quot;</span>
</span><span class="code-line">    loop_thread <span class="token operator">=</span> threading<span class="token punctuation">.</span><span class="token function property-access method">current_thread</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&#x27;loop_thread: {}&#x27;</span><span class="token punctuation">.</span><span class="token function property-access method">format</span><span class="token punctuation">(</span>loop_thread<span class="token punctuation">.</span><span class="token property-access">name</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  # loop_thread<span class="token operator">:</span> loop_thread
</span><span class="code-line">    n <span class="token operator">=</span> <span class="token number">0</span>
</span><span class="code-line">    <span class="token keyword control-flow">while</span> n <span class="token operator">&lt;</span> <span class="token number">5</span><span class="token operator">:</span>
</span><span class="code-line">        <span class="token function">print</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span>  # <span class="token number">0</span> <span class="token number">1</span> <span class="token number">2</span> <span class="token number">3</span> <span class="token number">4</span>
</span><span class="code-line">        n <span class="token operator">+=</span> <span class="token number">1</span>
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line">def <span class="token function">use_thread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span>
</span><span class="code-line">    <span class="token string">&quot;&quot;</span><span class="token string">&quot; 新的线程执行函数 &quot;</span><span class="token string">&quot;&quot;</span>
</span><span class="code-line">    now_thread <span class="token operator">=</span> threading<span class="token punctuation">.</span><span class="token function property-access method">current_thread</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&#x27;now_thread: {}&#x27;</span><span class="token punctuation">.</span><span class="token function property-access method">format</span><span class="token punctuation">(</span>now_thread<span class="token punctuation">.</span><span class="token property-access">name</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  # now_thread<span class="token operator">:</span> <span class="token maybe-class-name">MainThread</span>
</span><span class="code-line">    # 创建线程
</span><span class="code-line">    t <span class="token operator">=</span> threading<span class="token punctuation">.</span><span class="token function property-access method"><span class="token maybe-class-name">Thread</span></span><span class="token punctuation">(</span>target<span class="token operator">=</span>loop<span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">&#x27;loop_thread&#x27;</span><span class="token punctuation">)</span>
</span><span class="code-line">    # 启动线程
</span><span class="code-line">    t<span class="token punctuation">.</span><span class="token function property-access method">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">    # 挂起线程
</span><span class="code-line">    t<span class="token punctuation">.</span><span class="token function property-access method">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword control-flow">if</span> __name__ <span class="token operator">==</span> <span class="token string">&#x27;__main__&#x27;</span><span class="token operator">:</span>
</span><span class="code-line">    <span class="token function">use_thread</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span></code></pre></div><ol start="7"><li>线程实现(面向对象)</li></ol><div class="relative"><pre><code class="language-js code-highlight"><span class="code-line"><span class="token keyword module">import</span> threading
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">class</span> <span class="token class-name">LoopThread</span><span class="token punctuation">(</span>threading<span class="token punctuation">.</span><span class="token property-access"><span class="token maybe-class-name">Thread</span></span><span class="token punctuation">)</span><span class="token operator">:</span>
</span><span class="code-line">    <span class="token string">&quot;&quot;</span><span class="token string">&quot; 自定义线程 &quot;</span><span class="token string">&quot;&quot;</span>
</span><span class="code-line">    n <span class="token operator">=</span> <span class="token number">0</span>
</span><span class="code-line">
</span><span class="code-line">    def <span class="token function">run</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token operator">:</span>
</span><span class="code-line">        loop_thread <span class="token operator">=</span> threading<span class="token punctuation">.</span><span class="token function property-access method">current_thread</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&#x27;loop_thread: {}&#x27;</span><span class="token punctuation">.</span><span class="token function property-access method">format</span><span class="token punctuation">(</span>loop_thread<span class="token punctuation">.</span><span class="token property-access">name</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  # loop_thread<span class="token operator">:</span> loop_thread
</span><span class="code-line">        <span class="token keyword control-flow">while</span> self<span class="token punctuation">.</span><span class="token property-access">n</span> <span class="token operator">&lt;</span> <span class="token number">5</span><span class="token operator">:</span>
</span><span class="code-line">            <span class="token function">print</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span><span class="token property-access">n</span><span class="token punctuation">)</span>  # <span class="token number">0</span> <span class="token number">1</span> <span class="token number">2</span> <span class="token number">3</span> <span class="token number">4</span>
</span><span class="code-line">            self<span class="token punctuation">.</span><span class="token property-access">n</span> <span class="token operator">+=</span> <span class="token number">1</span>
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword control-flow">if</span> __name__ <span class="token operator">==</span> <span class="token string">&#x27;__main__&#x27;</span><span class="token operator">:</span>
</span><span class="code-line">    now_thread <span class="token operator">=</span> threading<span class="token punctuation">.</span><span class="token function property-access method">current_thread</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&#x27;now_thread: {}&#x27;</span><span class="token punctuation">.</span><span class="token function property-access method">format</span><span class="token punctuation">(</span>now_thread<span class="token punctuation">.</span><span class="token property-access">name</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  # now_thread<span class="token operator">:</span> <span class="token maybe-class-name">MainThread</span>
</span><span class="code-line">    # 创建线程
</span><span class="code-line">    t <span class="token operator">=</span> <span class="token function"><span class="token maybe-class-name">LoopThread</span></span><span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">&#x27;loop_thread&#x27;</span><span class="token punctuation">)</span>
</span><span class="code-line">    # 启动线程
</span><span class="code-line">    t<span class="token punctuation">.</span><span class="token function property-access method">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">    # 挂起线程
</span><span class="code-line">    t<span class="token punctuation">.</span><span class="token function property-access method">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span></code></pre></div><ol start="8"><li>多线程及存在的问题</li></ol><div class="relative"><pre><code class="language-js code-highlight"><span class="code-line"><span class="token keyword module">import</span> threading
</span><span class="code-line">
</span><span class="code-line"># 我的银行账户
</span><span class="code-line">balance <span class="token operator">=</span> <span class="token number">0</span>
</span><span class="code-line">
</span><span class="code-line">def <span class="token function">change</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token operator">:</span>
</span><span class="code-line">    global balance  # 局部作用域如果要修改全局变量，则需要global关键字声明。
</span><span class="code-line">    balance <span class="token operator">=</span> balance <span class="token operator">+</span> n
</span><span class="code-line">    balance <span class="token operator">=</span> balance <span class="token operator">-</span> n
</span><span class="code-line">    <span class="token keyword control-flow">if</span> balance <span class="token operator">!=</span> <span class="token number">0</span><span class="token operator">:</span>
</span><span class="code-line">        <span class="token function">print</span><span class="token punctuation">(</span>balance<span class="token punctuation">)</span> # balance有可能是<span class="token operator">-</span><span class="token number">8</span> <span class="token operator">-</span><span class="token number">5</span> <span class="token number">0</span> <span class="token number">5</span> <span class="token number">8</span>
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">class</span> <span class="token class-name">ChangeBalanceThread</span><span class="token punctuation">(</span>threading<span class="token punctuation">.</span><span class="token property-access"><span class="token maybe-class-name">Thread</span></span><span class="token punctuation">)</span><span class="token operator">:</span>
</span><span class="code-line">
</span><span class="code-line">    def <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> num<span class="token punctuation">,</span> <span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token operator">:</span>
</span><span class="code-line">        <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function property-access method">__init__</span><span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span>
</span><span class="code-line">        self<span class="token punctuation">.</span><span class="token property-access">num</span> <span class="token operator">=</span> num
</span><span class="code-line">
</span><span class="code-line">    def <span class="token function">run</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token operator">:</span>
</span><span class="code-line">        <span class="token keyword control-flow">for</span> i <span class="token keyword">in</span> <span class="token function">range</span><span class="token punctuation">(</span><span class="token number">100000</span><span class="token punctuation">)</span><span class="token operator">:</span>
</span><span class="code-line">            <span class="token function">change</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span><span class="token property-access">num</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword control-flow">if</span> __name__ <span class="token operator">==</span> <span class="token string">&#x27;__main__&#x27;</span><span class="token operator">:</span>
</span><span class="code-line">    # 创建线程
</span><span class="code-line">    t1 <span class="token operator">=</span> <span class="token function"><span class="token maybe-class-name">ChangeBalanceThread</span></span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
</span><span class="code-line">    t2 <span class="token operator">=</span> <span class="token function"><span class="token maybe-class-name">ChangeBalanceThread</span></span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span>
</span><span class="code-line">    # 启动线程
</span><span class="code-line">    t1<span class="token punctuation">.</span><span class="token function property-access method">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">    t2<span class="token punctuation">.</span><span class="token function property-access method">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">    # 挂起线程
</span><span class="code-line">    t1<span class="token punctuation">.</span><span class="token function property-access method">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">    t2<span class="token punctuation">.</span><span class="token function property-access method">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span></code></pre></div><p>注意：局部作用域如果要修改全局变量，则需要<code>global</code>关键字声明。 9. 锁</p><div class="relative"><pre><code class="language-js code-highlight"><span class="code-line"><span class="token keyword module">import</span> threading
</span><span class="code-line">
</span><span class="code-line"># 锁
</span><span class="code-line">my_lock <span class="token operator">=</span> threading<span class="token punctuation">.</span><span class="token function property-access method"><span class="token maybe-class-name">Lock</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line"># 我的银行账户
</span><span class="code-line">balance <span class="token operator">=</span> <span class="token number">0</span>
</span><span class="code-line">
</span><span class="code-line">def <span class="token function">change</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token operator">:</span>
</span><span class="code-line">    global balance  # 局部作用域如果要修改全局变量，则需要global关键字声明。
</span><span class="code-line">    # 添加锁
</span><span class="code-line">    my_lock<span class="token punctuation">.</span><span class="token function property-access method">acquire</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token keyword control-flow">try</span><span class="token operator">:</span>
</span><span class="code-line">        balance <span class="token operator">=</span> balance <span class="token operator">+</span> n
</span><span class="code-line">        balance <span class="token operator">=</span> balance <span class="token operator">-</span> n
</span><span class="code-line">        <span class="token keyword control-flow">if</span> balance <span class="token operator">!=</span> <span class="token number">0</span><span class="token operator">:</span>
</span><span class="code-line">            <span class="token function">print</span><span class="token punctuation">(</span>balance<span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token keyword control-flow">finally</span><span class="token operator">:</span>
</span><span class="code-line">        # 释放锁
</span><span class="code-line">        my_lock<span class="token punctuation">.</span><span class="token function property-access method">release</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">class</span> <span class="token class-name">ChangeBalanceThread</span><span class="token punctuation">(</span>threading<span class="token punctuation">.</span><span class="token property-access"><span class="token maybe-class-name">Thread</span></span><span class="token punctuation">)</span><span class="token operator">:</span>
</span><span class="code-line">
</span><span class="code-line">    def <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> num<span class="token punctuation">,</span> <span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token operator">:</span>
</span><span class="code-line">        <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function property-access method">__init__</span><span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span>
</span><span class="code-line">        self<span class="token punctuation">.</span><span class="token property-access">num</span> <span class="token operator">=</span> num
</span><span class="code-line">
</span><span class="code-line">    def <span class="token function">run</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token operator">:</span>
</span><span class="code-line">        <span class="token keyword control-flow">for</span> i <span class="token keyword">in</span> <span class="token function">range</span><span class="token punctuation">(</span><span class="token number">100000</span><span class="token punctuation">)</span><span class="token operator">:</span>
</span><span class="code-line">            <span class="token function">change</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span><span class="token property-access">num</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword control-flow">if</span> __name__ <span class="token operator">==</span> <span class="token string">&#x27;__main__&#x27;</span><span class="token operator">:</span>
</span><span class="code-line">    # 创建线程
</span><span class="code-line">    t1 <span class="token operator">=</span> <span class="token function"><span class="token maybe-class-name">ChangeBalanceThread</span></span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
</span><span class="code-line">    t2 <span class="token operator">=</span> <span class="token function"><span class="token maybe-class-name">ChangeBalanceThread</span></span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span>
</span><span class="code-line">    # 启动线程
</span><span class="code-line">    t1<span class="token punctuation">.</span><span class="token function property-access method">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">    t2<span class="token punctuation">.</span><span class="token function property-access method">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">    # 挂起线程
</span><span class="code-line">    t1<span class="token punctuation">.</span><span class="token function property-access method">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">    t2<span class="token punctuation">.</span><span class="token function property-access method">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span></code></pre></div><ol start="10"><li>锁的简单写法</li></ol><div class="relative"><pre><code class="language-js code-highlight"><span class="code-line"># 锁
</span><span class="code-line">my_lock <span class="token operator">=</span> threading<span class="token punctuation">.</span><span class="token function property-access method"><span class="token maybe-class-name">Lock</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line"># 我的银行账户
</span><span class="code-line">balance <span class="token operator">=</span> <span class="token number">0</span>
</span><span class="code-line">
</span><span class="code-line">def <span class="token function">change</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token operator">:</span>
</span><span class="code-line">    global balance 
</span><span class="code-line">    # 添加锁
</span><span class="code-line">    <span class="token keyword">with</span> <span class="token property literal-property">my_lock</span><span class="token operator">:</span>
</span><span class="code-line">        balance <span class="token operator">=</span> balance <span class="token operator">+</span> n
</span><span class="code-line">        balance <span class="token operator">=</span> balance <span class="token operator">-</span> n
</span><span class="code-line">        <span class="token keyword control-flow">if</span> balance <span class="token operator">!=</span> <span class="token number">0</span><span class="token operator">:</span>
</span><span class="code-line">            <span class="token function">print</span><span class="token punctuation">(</span>balance<span class="token punctuation">)</span>
</span></code></pre></div><ol start="11"><li>死锁</li></ol><div class="relative"><pre><code class="language-js code-highlight"><span class="code-line"># 锁
</span><span class="code-line">my_lock <span class="token operator">=</span> threading<span class="token punctuation">.</span><span class="token function property-access method"><span class="token maybe-class-name">Lock</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line"># 我的银行账户
</span><span class="code-line">balance <span class="token operator">=</span> <span class="token number">0</span>
</span><span class="code-line">
</span><span class="code-line">def <span class="token function">change</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token operator">:</span>
</span><span class="code-line">    global balance
</span><span class="code-line">    # 添加锁
</span><span class="code-line">    my_lock<span class="token punctuation">.</span><span class="token function property-access method">acquire</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">    my_lock<span class="token punctuation">.</span><span class="token function property-access method">acquire</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token keyword control-flow">try</span><span class="token operator">:</span>
</span><span class="code-line">        balance <span class="token operator">=</span> balance <span class="token operator">+</span> n
</span><span class="code-line">        balance <span class="token operator">=</span> balance <span class="token operator">-</span> n
</span><span class="code-line">        <span class="token function">print</span><span class="token punctuation">(</span>balance<span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token keyword control-flow">finally</span><span class="token operator">:</span>
</span><span class="code-line">        # 释放锁
</span><span class="code-line">        my_lock<span class="token punctuation">.</span><span class="token function property-access method">release</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">        my_lock<span class="token punctuation">.</span><span class="token function property-access method">release</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span></code></pre></div><ol start="12"><li><code>threading.RLock</code> 我们使用<code>threading.Lock()</code>来进行加锁。<code>threading</code>中还提供了另外一个<code>threading.RLock()</code>锁。在同一线程内，对<code>RLock</code>进行多次<code>acquire()</code>操作，程序不会阻塞。</li></ol><div class="relative"><pre><code class="language-js code-highlight"><span class="code-line"># 锁
</span><span class="code-line">my_lock <span class="token operator">=</span> threading<span class="token punctuation">.</span><span class="token function property-access method"><span class="token maybe-class-name">RLock</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line"># 我的银行账户
</span><span class="code-line">balance <span class="token operator">=</span> <span class="token number">0</span>
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line">def <span class="token function">change</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token operator">:</span>
</span><span class="code-line">    global balance  # 局部作用域如果要修改全局变量，则需要global关键字声明。
</span><span class="code-line">    # 添加锁
</span><span class="code-line">    my_lock<span class="token punctuation">.</span><span class="token function property-access method">acquire</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">    my_lock<span class="token punctuation">.</span><span class="token function property-access method">acquire</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token keyword control-flow">try</span><span class="token operator">:</span>
</span><span class="code-line">        balance <span class="token operator">=</span> balance <span class="token operator">+</span> n
</span><span class="code-line">        balance <span class="token operator">=</span> balance <span class="token operator">-</span> n
</span><span class="code-line">        <span class="token function">print</span><span class="token punctuation">(</span>balance<span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token keyword control-flow">finally</span><span class="token operator">:</span>
</span><span class="code-line">        # 释放锁
</span><span class="code-line">        my_lock<span class="token punctuation">.</span><span class="token function property-access method">release</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">        my_lock<span class="token punctuation">.</span><span class="token function property-access method">release</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span></code></pre></div><ol start="13"><li>使用线程池</li></ol><div class="relative"><pre><code class="language-js code-highlight"><span class="code-line"><span class="token keyword module">import</span> time
</span><span class="code-line"><span class="token keyword module">import</span> <span class="token imports">threading</span>
</span><span class="code-line"><span class="token keyword module">from</span> concurrent<span class="token punctuation">.</span><span class="token property-access">futures</span><span class="token punctuation">.</span><span class="token property-access">thread</span> <span class="token keyword module">import</span> <span class="token imports"><span class="token maybe-class-name">ThreadPoolExecutor</span></span>
</span><span class="code-line"><span class="token keyword module">from</span> multiprocessing<span class="token punctuation">.</span><span class="token property-access">dummy</span> <span class="token keyword module">import</span> <span class="token maybe-class-name">Pool</span>
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line">def <span class="token function">run</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token operator">:</span>
</span><span class="code-line">    <span class="token string">&quot;&quot;</span><span class="token string">&quot; 线程要做的事情 &quot;</span><span class="token string">&quot;&quot;</span>
</span><span class="code-line">    time<span class="token punctuation">.</span><span class="token function property-access method">sleep</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&#x27;thread: {}; n: {}&#x27;</span><span class="token punctuation">.</span><span class="token function property-access method">format</span><span class="token punctuation">(</span>threading<span class="token punctuation">.</span><span class="token function property-access method">current_thread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">name</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line">def <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span>
</span><span class="code-line">    <span class="token string">&quot;&quot;</span><span class="token string">&quot; 主线程做任务 &quot;</span><span class="token string">&quot;&quot;</span>
</span><span class="code-line">    t1 <span class="token operator">=</span> time<span class="token punctuation">.</span><span class="token function property-access method">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token keyword control-flow">for</span> n <span class="token keyword">in</span> <span class="token function">range</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token operator">:</span>
</span><span class="code-line">        <span class="token function">run</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token function">print</span><span class="token punctuation">(</span>time<span class="token punctuation">.</span><span class="token function property-access method">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> t1<span class="token punctuation">)</span>  # <span class="token number">100</span><span class="token punctuation">.</span>30s
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line">def <span class="token function">main_use_thread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span>
</span><span class="code-line">    <span class="token string">&quot;&quot;</span><span class="token string">&quot; 多线程做任务。10个线程。&quot;</span><span class="token string">&quot;&quot;</span>
</span><span class="code-line">    t2 <span class="token operator">=</span> time<span class="token punctuation">.</span><span class="token function property-access method">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">    ls <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
</span><span class="code-line">    <span class="token keyword control-flow">for</span> i <span class="token keyword">in</span> <span class="token function">range</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token operator">:</span>
</span><span class="code-line">        t <span class="token operator">=</span> threading<span class="token punctuation">.</span><span class="token function property-access method"><span class="token maybe-class-name">Thread</span></span><span class="token punctuation">(</span>target<span class="token operator">=</span>run<span class="token punctuation">,</span> args<span class="token operator">=</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">        ls<span class="token punctuation">.</span><span class="token function property-access method">append</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span>
</span><span class="code-line">        t<span class="token punctuation">.</span><span class="token function property-access method">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token keyword control-flow">for</span> l <span class="token keyword">in</span> <span class="token property literal-property">ls</span><span class="token operator">:</span>
</span><span class="code-line">        l<span class="token punctuation">.</span><span class="token function property-access method">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token function">print</span><span class="token punctuation">(</span>time<span class="token punctuation">.</span><span class="token function property-access method">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> t2<span class="token punctuation">)</span>  # <span class="token number">1</span><span class="token punctuation">.</span>01s
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line">def <span class="token function">main_use_pool</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span>
</span><span class="code-line">    <span class="token string">&quot;&quot;</span><span class="token string">&quot; 线程池 &quot;</span><span class="token string">&quot;&quot;</span>
</span><span class="code-line">    t3 <span class="token operator">=</span> time<span class="token punctuation">.</span><span class="token function property-access method">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">    pool <span class="token operator">=</span> <span class="token function"><span class="token maybe-class-name">Pool</span></span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
</span><span class="code-line">    n_list <span class="token operator">=</span> <span class="token function">range</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span>
</span><span class="code-line">    pool<span class="token punctuation">.</span><span class="token function property-access method">map</span><span class="token punctuation">(</span>run<span class="token punctuation">,</span> n_list<span class="token punctuation">)</span>
</span><span class="code-line">    pool<span class="token punctuation">.</span><span class="token function property-access method">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">    pool<span class="token punctuation">.</span><span class="token function property-access method">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token function">print</span><span class="token punctuation">(</span>time<span class="token punctuation">.</span><span class="token function property-access method">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> t3<span class="token punctuation">)</span>  # <span class="token number">12</span><span class="token punctuation">.</span>08s
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line">def <span class="token function">main_use_executor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span>
</span><span class="code-line">    <span class="token string">&quot;&quot;</span><span class="token string">&quot; 使用ThreadPoolExecutor来优化 &quot;</span><span class="token string">&quot;&quot;</span>
</span><span class="code-line">    t4 <span class="token operator">=</span> time<span class="token punctuation">.</span><span class="token function property-access method">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">    n_list <span class="token operator">=</span> <span class="token function">range</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token keyword">with</span> <span class="token function"><span class="token maybe-class-name">ThreadPoolExecutor</span></span><span class="token punctuation">(</span>max_workers<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token keyword module">as</span> <span class="token property literal-property">executor</span><span class="token operator">:</span>
</span><span class="code-line">        executor<span class="token punctuation">.</span><span class="token function property-access method">map</span><span class="token punctuation">(</span>run<span class="token punctuation">,</span> n_list<span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token function">print</span><span class="token punctuation">(</span>time<span class="token punctuation">.</span><span class="token function property-access method">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> t4<span class="token punctuation">)</span>  # <span class="token number">10</span><span class="token punctuation">.</span>03s
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword control-flow">if</span> __name__ <span class="token operator">==</span> <span class="token string">&#x27;__main__&#x27;</span><span class="token operator">:</span>
</span><span class="code-line">    <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token function">main_use_thread</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token function">main_use_pool</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token function">main_use_executor</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span></code></pre></div><p>注意：线程传参的方式<code>threading.Thread(target=run, args=(i,))</code>。其中，<code>(i,)</code>表示元组。</p><h2 class="content-header" id="23-进程"><a class="break-words" href="#23-进程" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>2.3 进程</h2><ol><li>进程介绍 是一个执行中的程序。 每个进程都拥有<strong>自己的</strong>地址空间、内存、数据栈以及其他用于跟踪执行的辅助数据。 操作系统管理所有进程的执行，并为这些进程合理地分配时间。 进程也可通过派生(<code>fork</code>或<code>spawn</code>)新的进程来执行其他任务。</li><li>进程实现(面向过程)</li></ol><div class="relative"><pre><code class="language-js code-highlight"><span class="code-line"><span class="token keyword module">import</span> os
</span><span class="code-line"><span class="token keyword module">import</span> <span class="token imports">time</span>
</span><span class="code-line"><span class="token keyword module">from</span> multiprocessing <span class="token keyword module">import</span> <span class="token maybe-class-name">Process</span>
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line">def <span class="token function">do_sth</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token operator">:</span>
</span><span class="code-line">    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;进程名称: {}, pid: {}&quot;</span><span class="token punctuation">.</span><span class="token function property-access method">format</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> os<span class="token punctuation">.</span><span class="token function property-access method">getpid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  # 进程名称<span class="token operator">:</span> my_process<span class="token punctuation">,</span> <span class="token property literal-property">pid</span><span class="token operator">:</span> <span class="token number">47634</span>
</span><span class="code-line">    time<span class="token punctuation">.</span><span class="token function property-access method">sleep</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;进程要做的事情结束&quot;</span><span class="token punctuation">)</span>  # 进程要做的事情结束
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword control-flow">if</span> __name__ <span class="token operator">==</span> <span class="token string">&#x27;__main__&#x27;</span><span class="token operator">:</span>
</span><span class="code-line">    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&#x27;当前进程pid: {}&#x27;</span><span class="token punctuation">.</span><span class="token function property-access method">format</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span><span class="token function property-access method">getpid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  # 当前进程名称<span class="token operator">:</span> <span class="token number">47651</span>
</span><span class="code-line">    p <span class="token operator">=</span> <span class="token function"><span class="token maybe-class-name">Process</span></span><span class="token punctuation">(</span>target<span class="token operator">=</span>do_sth<span class="token punctuation">,</span> args<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">&#x27;my_process&#x27;</span><span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">    # 启动进程
</span><span class="code-line">    p<span class="token punctuation">.</span><span class="token function property-access method">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">    # 挂起进程
</span><span class="code-line">    p<span class="token punctuation">.</span><span class="token function property-access method">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span></code></pre></div><ol start="3"><li>进程实现(面向对象)</li></ol><div class="relative"><pre><code class="language-js code-highlight"><span class="code-line"><span class="token keyword module">import</span> os
</span><span class="code-line"><span class="token keyword module">import</span> <span class="token imports">time</span>
</span><span class="code-line"><span class="token keyword module">from</span> multiprocessing <span class="token keyword module">import</span> <span class="token maybe-class-name">Process</span>
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">class</span> <span class="token class-name">MyProcess</span><span class="token punctuation">(</span><span class="token maybe-class-name">Process</span><span class="token punctuation">)</span><span class="token operator">:</span>
</span><span class="code-line">    def <span class="token function">run</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token operator">:</span>
</span><span class="code-line">        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;进程名称: {}, pid: {}&quot;</span><span class="token punctuation">.</span><span class="token function property-access method">format</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span><span class="token property-access">name</span><span class="token punctuation">,</span> os<span class="token punctuation">.</span><span class="token function property-access method">getpid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  # 进程名称<span class="token operator">:</span> my_process<span class="token punctuation">,</span> <span class="token property literal-property">pid</span><span class="token operator">:</span> <span class="token number">47758</span>
</span><span class="code-line">        time<span class="token punctuation">.</span><span class="token function property-access method">sleep</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
</span><span class="code-line">        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;进程要做的事情结束&quot;</span><span class="token punctuation">)</span>  # 进程要做的事情结束
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword control-flow">if</span> __name__ <span class="token operator">==</span> <span class="token string">&#x27;__main__&#x27;</span><span class="token operator">:</span>
</span><span class="code-line">    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&#x27;当前进程pid: {}&#x27;</span><span class="token punctuation">.</span><span class="token function property-access method">format</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span><span class="token function property-access method">getpid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  # 当前进程名称<span class="token operator">:</span> <span class="token number">47757</span>
</span><span class="code-line">    p <span class="token operator">=</span> <span class="token function"><span class="token maybe-class-name">MyProcess</span></span><span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">&#x27;my_process&#x27;</span><span class="token punctuation">)</span>
</span><span class="code-line">    # 启动进程
</span><span class="code-line">    p<span class="token punctuation">.</span><span class="token function property-access method">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">    # 挂起进程
</span><span class="code-line">    p<span class="token punctuation">.</span><span class="token function property-access method">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span></code></pre></div><ol start="4"><li>进程之间通信 通过<code>Queue</code>、<code>Pipes</code>等实现进程之间的通信。</li></ol><div class="relative"><pre><code class="language-js code-highlight"><span class="code-line"><span class="token keyword module">import</span> time
</span><span class="code-line"><span class="token keyword module">import</span> <span class="token imports">random</span>
</span><span class="code-line"><span class="token keyword module">from</span> multiprocessing <span class="token keyword module">import</span> <span class="token maybe-class-name">Process</span><span class="token punctuation">,</span> <span class="token maybe-class-name">Queue</span><span class="token punctuation">,</span> current_process
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">class</span> <span class="token class-name">WriteProcess</span><span class="token punctuation">(</span><span class="token maybe-class-name">Process</span><span class="token punctuation">)</span><span class="token operator">:</span>
</span><span class="code-line">    <span class="token string">&quot;&quot;</span><span class="token string">&quot; 写入的进程 &quot;</span><span class="token string">&quot;&quot;</span>
</span><span class="code-line">    def <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> queue<span class="token punctuation">,</span> <span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token operator">:</span>
</span><span class="code-line">        self<span class="token punctuation">.</span><span class="token property-access">queue</span> <span class="token operator">=</span> queue
</span><span class="code-line">        <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function property-access method">__init__</span><span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">    def <span class="token function">run</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token operator">:</span>
</span><span class="code-line">        ls <span class="token operator">=</span> <span class="token punctuation">[</span>
</span><span class="code-line">            <span class="token string">&#x27;第1行内容&#x27;</span><span class="token punctuation">,</span>
</span><span class="code-line">            <span class="token string">&#x27;第2行内容&#x27;</span><span class="token punctuation">,</span>
</span><span class="code-line">            <span class="token string">&#x27;第3行内容&#x27;</span><span class="token punctuation">,</span>
</span><span class="code-line">            <span class="token string">&#x27;第4行内容&#x27;</span><span class="token punctuation">,</span>
</span><span class="code-line">            <span class="token string">&#x27;第5行内容&#x27;</span><span class="token punctuation">,</span>
</span><span class="code-line">        <span class="token punctuation">]</span>
</span><span class="code-line">        <span class="token keyword control-flow">for</span> line <span class="token keyword">in</span> <span class="token property literal-property">ls</span><span class="token operator">:</span>
</span><span class="code-line">            <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&#x27;进程名称: {}, 写入内容: {}&#x27;</span><span class="token punctuation">.</span><span class="token function property-access method">format</span><span class="token punctuation">(</span><span class="token function">current_process</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">name</span><span class="token punctuation">,</span> line<span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">            self<span class="token punctuation">.</span><span class="token property-access">queue</span><span class="token punctuation">.</span><span class="token function property-access method">put</span><span class="token punctuation">(</span>line<span class="token punctuation">)</span>
</span><span class="code-line">            # 没写入一次，休息<span class="token number">1</span><span class="token operator">-</span>3s
</span><span class="code-line">            time<span class="token punctuation">.</span><span class="token function property-access method">sleep</span><span class="token punctuation">(</span>random<span class="token punctuation">.</span><span class="token function property-access method">randint</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">class</span> <span class="token class-name">ReadProcess</span><span class="token punctuation">(</span><span class="token maybe-class-name">Process</span><span class="token punctuation">)</span><span class="token operator">:</span>
</span><span class="code-line">    <span class="token string">&quot;&quot;</span><span class="token string">&quot; 读取的进程 &quot;</span><span class="token string">&quot;&quot;</span>
</span><span class="code-line">    def <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> queue<span class="token punctuation">,</span> <span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token operator">:</span>
</span><span class="code-line">        self<span class="token punctuation">.</span><span class="token property-access">queue</span> <span class="token operator">=</span> queue
</span><span class="code-line">        <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function property-access method">__init__</span><span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">    def <span class="token function">run</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token operator">:</span>
</span><span class="code-line">        <span class="token keyword control-flow">while</span> <span class="token property literal-property">True</span><span class="token operator">:</span>
</span><span class="code-line">            content <span class="token operator">=</span> self<span class="token punctuation">.</span><span class="token property-access">queue</span><span class="token punctuation">.</span><span class="token function property-access method">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">            <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&#x27;进程名称: {}, 读取内容: {}&#x27;</span><span class="token punctuation">.</span><span class="token function property-access method">format</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span><span class="token property-access">name</span><span class="token punctuation">,</span> content<span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword control-flow">if</span> __name__ <span class="token operator">==</span> <span class="token string">&#x27;__main__&#x27;</span><span class="token operator">:</span>
</span><span class="code-line">    # 通过Queue共享数据
</span><span class="code-line">    q <span class="token operator">=</span> <span class="token function"><span class="token maybe-class-name">Queue</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">    # 写入内容的进程
</span><span class="code-line">    t_write <span class="token operator">=</span> <span class="token function"><span class="token maybe-class-name">WriteProcess</span></span><span class="token punctuation">(</span>q<span class="token punctuation">)</span>
</span><span class="code-line">    t_write<span class="token punctuation">.</span><span class="token function property-access method">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">    # 读取内容的进程
</span><span class="code-line">    t_read <span class="token operator">=</span> <span class="token function"><span class="token maybe-class-name">ReadProcess</span></span><span class="token punctuation">(</span>q<span class="token punctuation">)</span>
</span><span class="code-line">    t_read<span class="token punctuation">.</span><span class="token function property-access method">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">    t_write<span class="token punctuation">.</span><span class="token function property-access method">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">    # t_read<span class="token punctuation">.</span><span class="token function property-access method">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 
</span><span class="code-line">    t_read<span class="token punctuation">.</span><span class="token function property-access method">terminate</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span></code></pre></div><p>注意：进程类中的<code>self.name</code>等价于<code>current_process().name</code>。 5. 多进程中的锁</p><div class="relative"><pre><code class="language-js code-highlight"><span class="code-line"><span class="token keyword module">import</span> random
</span><span class="code-line"><span class="token keyword module">import</span> <span class="token imports">time</span>
</span><span class="code-line"><span class="token keyword module">from</span> multiprocessing <span class="token keyword module">import</span> <span class="token maybe-class-name">Process</span><span class="token punctuation">,</span> <span class="token maybe-class-name">Lock</span>
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">class</span> <span class="token class-name">WriteProcess</span><span class="token punctuation">(</span><span class="token maybe-class-name">Process</span><span class="token punctuation">)</span><span class="token operator">:</span>
</span><span class="code-line">    <span class="token string">&quot;&quot;</span><span class="token string">&quot; 写入文件 &quot;</span><span class="token string">&quot;&quot;</span>
</span><span class="code-line">    lock <span class="token operator">=</span> <span class="token function"><span class="token maybe-class-name">Lock</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">    def <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> file_name<span class="token punctuation">,</span> index<span class="token punctuation">,</span> <span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token operator">:</span>
</span><span class="code-line">        self<span class="token punctuation">.</span><span class="token property-access">file_name</span> <span class="token operator">=</span> file_name
</span><span class="code-line">        self<span class="token punctuation">.</span><span class="token property-access">index</span> <span class="token operator">=</span> index
</span><span class="code-line">        <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function property-access method">__init__</span><span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">    def <span class="token function">run</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token operator">:</span>
</span><span class="code-line">        <span class="token keyword">with</span> self<span class="token punctuation">.</span><span class="token property-access">lock</span><span class="token operator">:</span>
</span><span class="code-line">            <span class="token keyword control-flow">for</span> i <span class="token keyword">in</span> <span class="token function">range</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token operator">:</span>
</span><span class="code-line">                <span class="token keyword">with</span> <span class="token function">open</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span><span class="token property-access">file_name</span><span class="token punctuation">,</span> <span class="token string">&#x27;a+&#x27;</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">&#x27;utf-8&#x27;</span><span class="token punctuation">)</span> <span class="token keyword module">as</span> <span class="token property literal-property">f</span><span class="token operator">:</span>
</span><span class="code-line">                    content <span class="token operator">=</span> <span class="token string">&#x27;现在是: {}, pid为: {}, 进程序号为: {}\n&#x27;</span><span class="token punctuation">.</span><span class="token function property-access method">format</span><span class="token punctuation">(</span>
</span><span class="code-line">                        self<span class="token punctuation">.</span><span class="token property-access">name</span><span class="token punctuation">,</span>
</span><span class="code-line">                        self<span class="token punctuation">.</span><span class="token property-access">pid</span><span class="token punctuation">,</span>
</span><span class="code-line">                        self<span class="token punctuation">.</span><span class="token property-access">index</span>
</span><span class="code-line">                    <span class="token punctuation">)</span>
</span><span class="code-line">                    f<span class="token punctuation">.</span><span class="token function property-access method">write</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span>
</span><span class="code-line">                    time<span class="token punctuation">.</span><span class="token function property-access method">sleep</span><span class="token punctuation">(</span>random<span class="token punctuation">.</span><span class="token function property-access method">randint</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">                    <span class="token function">print</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword control-flow">if</span> __name__ <span class="token operator">==</span> <span class="token string">&#x27;__main__&#x27;</span><span class="token operator">:</span>
</span><span class="code-line">    file_name <span class="token operator">=</span> <span class="token string">&#x27;test.txt&#x27;</span>
</span><span class="code-line">    <span class="token keyword control-flow">for</span> i <span class="token keyword">in</span> <span class="token function">range</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token operator">:</span>
</span><span class="code-line">        p <span class="token operator">=</span> <span class="token function"><span class="token maybe-class-name">WriteProcess</span></span><span class="token punctuation">(</span>file_name<span class="token punctuation">,</span> i<span class="token punctuation">)</span>
</span><span class="code-line">        p<span class="token punctuation">.</span><span class="token function property-access method">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span></code></pre></div><ol start="6"><li><code>multiprocessing.RLock</code> 我们使用<code>multiprocessing.Lock()</code>来进行加锁。<code>multiprocessing</code>中还提供了另外一个<code>multiprocessing.RLock()</code>锁。在同一进程内，对<code>RLock</code>进行多次<code>acquire()</code>操作，程序不会阻塞。</li><li>进程池</li></ol><div class="relative"><pre><code class="language-js code-highlight"><span class="code-line"><span class="token keyword module">import</span> os
</span><span class="code-line"><span class="token keyword module">import</span> random
</span><span class="code-line"><span class="token keyword module">import</span> <span class="token imports">time</span>
</span><span class="code-line"><span class="token keyword module">from</span> multiprocessing <span class="token keyword module">import</span> current_process<span class="token punctuation">,</span> <span class="token maybe-class-name">Pool</span>
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line">def <span class="token function">run</span><span class="token punctuation">(</span>file_name<span class="token punctuation">,</span> index<span class="token punctuation">)</span><span class="token operator">:</span>
</span><span class="code-line">    <span class="token string">&quot;&quot;</span><span class="token string">&quot; 进程任务 &quot;</span><span class="token string">&quot;&quot;</span>
</span><span class="code-line">    <span class="token keyword">with</span> <span class="token function">open</span><span class="token punctuation">(</span>file_name<span class="token punctuation">,</span> <span class="token string">&#x27;a+&#x27;</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">&#x27;utf-8&#x27;</span><span class="token punctuation">)</span> <span class="token keyword module">as</span> <span class="token property literal-property">f</span><span class="token operator">:</span>
</span><span class="code-line">        now_process <span class="token operator">=</span> <span class="token function">current_process</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">        content <span class="token operator">=</span> <span class="token string">&#x27;{} - {} - {} \n&#x27;</span><span class="token punctuation">.</span><span class="token function property-access method">format</span><span class="token punctuation">(</span>
</span><span class="code-line">            now_process<span class="token punctuation">.</span><span class="token property-access">name</span><span class="token punctuation">,</span>
</span><span class="code-line">            now_process<span class="token punctuation">.</span><span class="token property-access">pid</span><span class="token punctuation">,</span>
</span><span class="code-line">            index
</span><span class="code-line">        <span class="token punctuation">)</span>
</span><span class="code-line">        f<span class="token punctuation">.</span><span class="token function property-access method">write</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span>
</span><span class="code-line">        time<span class="token punctuation">.</span><span class="token function property-access method">sleep</span><span class="token punctuation">(</span>random<span class="token punctuation">.</span><span class="token function property-access method">randint</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">        <span class="token function">print</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span>
</span><span class="code-line">        <span class="token keyword control-flow">return</span> <span class="token string">&#x27;OK&#x27;</span>
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword control-flow">if</span> __name__ <span class="token operator">==</span> <span class="token string">&#x27;__main__&#x27;</span><span class="token operator">:</span>
</span><span class="code-line">    # <span class="token function">print</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span><span class="token function property-access method">cpu_count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  # <span class="token number">4</span>核<span class="token constant">CPU</span>
</span><span class="code-line">    file_name <span class="token operator">=</span> <span class="token string">&#x27;test_pool.txt&#x27;</span>
</span><span class="code-line">    pool <span class="token operator">=</span> <span class="token function"><span class="token maybe-class-name">Pool</span></span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>  # 创建有两个进程的进程池
</span><span class="code-line">    <span class="token keyword control-flow">for</span> i <span class="token keyword">in</span> <span class="token function">range</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token operator">:</span>
</span><span class="code-line">        # 同步添加任务
</span><span class="code-line">        # rest <span class="token operator">=</span> pool<span class="token punctuation">.</span><span class="token function property-access method">apply</span><span class="token punctuation">(</span>run<span class="token punctuation">,</span> args<span class="token operator">=</span><span class="token punctuation">(</span>file_name<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">        # 异步添加任务
</span><span class="code-line">        rest <span class="token operator">=</span> pool<span class="token punctuation">.</span><span class="token function property-access method">apply_async</span><span class="token punctuation">(</span>run<span class="token punctuation">,</span> args<span class="token operator">=</span><span class="token punctuation">(</span>file_name<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&#x27;{} {}&#x27;</span><span class="token punctuation">.</span><span class="token function property-access method">format</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> rest<span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">    pool<span class="token punctuation">.</span><span class="token function property-access method">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  # 关闭进程池
</span><span class="code-line">    pool<span class="token punctuation">.</span><span class="token function property-access method">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span></code></pre></div><p>注释：异步添加任务，不能保证任务的执行顺序。同步添加任务，可以保证任务的执行顺序。</p><h2 class="content-header" id="24-协程"><a class="break-words" href="#24-协程" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>2.4 协程</h2><ol><li>协程介绍 协程就是协同多任务。 协程在一个进程或者是一个线程中执行。 协程不需要锁机制。</li><li><code>yield</code>生成器</li></ol><div class="relative"><pre><code class="language-js code-highlight"><span class="code-line">def <span class="token function">count_down</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token operator">:</span>
</span><span class="code-line">    <span class="token string">&quot;&quot;</span><span class="token string">&quot; 倒计时效果 &quot;</span><span class="token string">&quot;&quot;</span>
</span><span class="code-line">    <span class="token keyword control-flow">while</span> n <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token operator">:</span>
</span><span class="code-line">        <span class="token keyword control-flow">yield</span> n
</span><span class="code-line">        n <span class="token operator">-=</span> <span class="token number">1</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword control-flow">if</span> __name__ <span class="token operator">==</span> <span class="token string">&#x27;__main__&#x27;</span><span class="token operator">:</span>
</span><span class="code-line">    rest <span class="token operator">=</span> <span class="token function">count_down</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token function">print</span><span class="token punctuation">(</span><span class="token function">next</span><span class="token punctuation">(</span>rest<span class="token punctuation">)</span><span class="token punctuation">)</span>  # <span class="token number">5</span>
</span><span class="code-line">    <span class="token function">print</span><span class="token punctuation">(</span><span class="token function">next</span><span class="token punctuation">(</span>rest<span class="token punctuation">)</span><span class="token punctuation">)</span>  # <span class="token number">4</span>
</span><span class="code-line">    <span class="token function">print</span><span class="token punctuation">(</span><span class="token function">next</span><span class="token punctuation">(</span>rest<span class="token punctuation">)</span><span class="token punctuation">)</span>  # <span class="token number">3</span>
</span><span class="code-line">    <span class="token function">print</span><span class="token punctuation">(</span><span class="token function">next</span><span class="token punctuation">(</span>rest<span class="token punctuation">)</span><span class="token punctuation">)</span>  # <span class="token number">2</span>
</span><span class="code-line">    <span class="token function">print</span><span class="token punctuation">(</span><span class="token function">next</span><span class="token punctuation">(</span>rest<span class="token punctuation">)</span><span class="token punctuation">)</span>  # <span class="token number">1</span>
</span></code></pre></div><ol start="3"><li><code>Python3.5</code>以前协程实现 使用生成器(<code>yield</code>)实现</li></ol><div class="relative"><pre><code class="language-js code-highlight"><span class="code-line">def <span class="token function">yield_test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span>
</span><span class="code-line">    <span class="token string">&quot;&quot;</span><span class="token string">&quot; 实现协程函数 &quot;</span><span class="token string">&quot;&quot;</span>
</span><span class="code-line">    <span class="token keyword control-flow">while</span> <span class="token property literal-property">True</span><span class="token operator">:</span>
</span><span class="code-line">        n <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword control-flow">yield</span> <span class="token punctuation">)</span>
</span><span class="code-line">        <span class="token function">print</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword control-flow">if</span> __name__ <span class="token operator">==</span> <span class="token string">&#x27;__main__&#x27;</span><span class="token operator">:</span>
</span><span class="code-line">    rest <span class="token operator">=</span> <span class="token function">yield_test</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token function">next</span><span class="token punctuation">(</span>rest<span class="token punctuation">)</span>
</span><span class="code-line">    rest<span class="token punctuation">.</span><span class="token function property-access method">send</span><span class="token punctuation">(</span><span class="token string">&#x27;1&#x27;</span><span class="token punctuation">)</span>  # <span class="token number">1</span>
</span><span class="code-line">    rest<span class="token punctuation">.</span><span class="token function property-access method">send</span><span class="token punctuation">(</span><span class="token string">&#x27;2&#x27;</span><span class="token punctuation">)</span>  # <span class="token number">2</span>
</span></code></pre></div><ol start="4"><li><code>Python3.5</code>以后协程实现 使用<code>async</code>和<code>await</code>关键字实现</li></ol><div class="relative"><pre><code class="language-js code-highlight"><span class="code-line"><span class="token keyword module">import</span> asyncio
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">async</span> def <span class="token function">do_sth</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token operator">:</span>
</span><span class="code-line">    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;等待中: {}&quot;</span><span class="token punctuation">.</span><span class="token function property-access method">format</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token keyword control-flow">await</span> asyncio<span class="token punctuation">.</span><span class="token function property-access method">sleep</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line"># 判断是否是协程函数
</span><span class="code-line"><span class="token function">print</span><span class="token punctuation">(</span>asyncio<span class="token punctuation">.</span><span class="token function property-access method">iscoroutinefunction</span><span class="token punctuation">(</span><span class="token parameter">do_sth</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  # <span class="token maybe-class-name">True</span>
</span><span class="code-line">
</span><span class="code-line"># 创建任务
</span><span class="code-line">coroutine <span class="token operator">=</span> <span class="token function">do_sth</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
</span><span class="code-line"># 创建事件循环队列
</span><span class="code-line">loop <span class="token operator">=</span> asyncio<span class="token punctuation">.</span><span class="token function property-access method">get_event_loop</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line"># 注册任务
</span><span class="code-line">task <span class="token operator">=</span> loop<span class="token punctuation">.</span><span class="token function property-access method">create_task</span><span class="token punctuation">(</span>coroutine<span class="token punctuation">)</span>
</span><span class="code-line"><span class="token function">print</span><span class="token punctuation">(</span>task<span class="token punctuation">)</span>  # <span class="token operator">&lt;</span><span class="token maybe-class-name">Task</span> pending coro<span class="token operator">=</span><span class="token operator">&lt;</span><span class="token function">do_sth</span><span class="token punctuation">(</span><span class="token punctuation">)</span> running at <span class="token operator">/</span><span class="token maybe-class-name">Users</span><span class="token operator">/</span>nimengwei<span class="token operator">/</span><span class="token maybe-class-name">Code</span><span class="token operator">/</span>mycode<span class="token operator">/</span>python<span class="token operator">/</span><span class="token maybe-class-name">Python零基础入门</span><span class="token operator">/</span><span class="token maybe-class-name">Python基础知识</span><span class="token operator">/</span>chapter09<span class="token operator">/</span>async_test<span class="token punctuation">.</span><span class="token property-access">py</span><span class="token operator">:</span><span class="token number">4</span><span class="token operator">&gt;&gt;</span>
</span><span class="code-line"># 等待协程任务执行结束
</span><span class="code-line">loop<span class="token punctuation">.</span><span class="token function property-access method">run_until_complete</span><span class="token punctuation">(</span>task<span class="token punctuation">)</span>
</span><span class="code-line"><span class="token function">print</span><span class="token punctuation">(</span>task<span class="token punctuation">)</span>  # <span class="token operator">&lt;</span><span class="token maybe-class-name">Task</span> finished coro<span class="token operator">=</span><span class="token operator">&lt;</span><span class="token function">do_sth</span><span class="token punctuation">(</span><span class="token punctuation">)</span> done<span class="token punctuation">,</span> defined at <span class="token operator">/</span><span class="token maybe-class-name">Users</span><span class="token operator">/</span>nimengwei<span class="token operator">/</span><span class="token maybe-class-name">Code</span><span class="token operator">/</span>mycode<span class="token operator">/</span>python<span class="token operator">/</span><span class="token maybe-class-name">Python零基础入门</span><span class="token operator">/</span><span class="token maybe-class-name">Python基础知识</span><span class="token operator">/</span>chapter09<span class="token operator">/</span>async_test<span class="token punctuation">.</span><span class="token property-access">py</span><span class="token operator">:</span><span class="token number">4</span><span class="token operator">&gt;</span> result<span class="token operator">=</span><span class="token maybe-class-name">None</span><span class="token operator">&gt;</span>
</span></code></pre></div><p>注意：必须使用<code>asyncio.sleep()</code>，不能使用<code>time.sleep()</code>。只有前者能返回一个协程对象。 5. 协程通信之嵌套调用</p><div class="relative"><pre><code class="language-js code-highlight"><span class="code-line"><span class="token keyword module">import</span> asyncio
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">async</span> def <span class="token function">compute</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token operator">:</span>
</span><span class="code-line">    <span class="token keyword control-flow">await</span> asyncio<span class="token punctuation">.</span><span class="token function property-access method">sleep</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token keyword control-flow">return</span> x <span class="token operator">+</span> y
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">async</span> def <span class="token function">get_sum</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token operator">:</span>
</span><span class="code-line">    rest <span class="token operator">=</span> <span class="token keyword control-flow">await</span> <span class="token function">compute</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;计算{} + {} = {}&quot;</span><span class="token punctuation">.</span><span class="token function property-access method">format</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> rest<span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">loop <span class="token operator">=</span> asyncio<span class="token punctuation">.</span><span class="token function property-access method">get_event_loop</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line"># loop<span class="token punctuation">.</span><span class="token function property-access method">run_until_complete</span><span class="token punctuation">(</span>loop<span class="token punctuation">.</span><span class="token function property-access method">create_task</span><span class="token punctuation">(</span><span class="token function">get_sum</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">loop<span class="token punctuation">.</span><span class="token function property-access method">run_until_complete</span><span class="token punctuation">(</span><span class="token function">get_sum</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">loop<span class="token punctuation">.</span><span class="token function property-access method">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span></code></pre></div><ol start="6"><li>协程通信之队列</li></ol><div class="relative"><pre><code class="language-js code-highlight"><span class="code-line"><span class="token keyword module">import</span> asyncio
</span><span class="code-line"><span class="token keyword module">import</span> random
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">async</span> def <span class="token function">add</span><span class="token punctuation">(</span>store<span class="token punctuation">)</span><span class="token operator">:</span>
</span><span class="code-line">    <span class="token string">&quot;&quot;</span><span class="token string">&quot; 写入数据到队列 &quot;</span><span class="token string">&quot;&quot;</span>
</span><span class="code-line">    <span class="token keyword control-flow">for</span> i <span class="token keyword">in</span> <span class="token function">range</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token operator">:</span>
</span><span class="code-line">        <span class="token keyword control-flow">await</span> asyncio<span class="token punctuation">.</span><span class="token function property-access method">sleep</span><span class="token punctuation">(</span>random<span class="token punctuation">.</span><span class="token function property-access method">randint</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">        <span class="token keyword control-flow">await</span> store<span class="token punctuation">.</span><span class="token function property-access method">put</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>
</span><span class="code-line">        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&#x27;add {}, queue size: {}&#x27;</span><span class="token punctuation">.</span><span class="token function property-access method">format</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> store<span class="token punctuation">.</span><span class="token function property-access method">qsize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">async</span> def <span class="token function">reduce</span><span class="token punctuation">(</span>store<span class="token punctuation">)</span><span class="token operator">:</span>
</span><span class="code-line">    <span class="token string">&quot;&quot;</span><span class="token string">&quot; 从队列中删除数据 &quot;</span><span class="token string">&quot;&quot;</span>
</span><span class="code-line">    <span class="token keyword control-flow">for</span> i <span class="token keyword">in</span> <span class="token function">range</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token operator">:</span>
</span><span class="code-line">        rest <span class="token operator">=</span> <span class="token keyword control-flow">await</span> store<span class="token punctuation">.</span><span class="token function property-access method">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&#x27;reduce {}, queue size: {}&#x27;</span><span class="token punctuation">.</span><span class="token function property-access method">format</span><span class="token punctuation">(</span>rest<span class="token punctuation">,</span> store<span class="token punctuation">.</span><span class="token function property-access method">qsize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword control-flow">if</span> __name__ <span class="token operator">==</span> <span class="token string">&#x27;__main__&#x27;</span><span class="token operator">:</span>
</span><span class="code-line">    # 准备一个队列
</span><span class="code-line">    store <span class="token operator">=</span> asyncio<span class="token punctuation">.</span><span class="token function property-access method"><span class="token maybe-class-name">Queue</span></span><span class="token punctuation">(</span>maxsize<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span>
</span><span class="code-line">    a1 <span class="token operator">=</span> <span class="token function">add</span><span class="token punctuation">(</span>store<span class="token punctuation">)</span>
</span><span class="code-line">    a2 <span class="token operator">=</span> <span class="token function">add</span><span class="token punctuation">(</span>store<span class="token punctuation">)</span>
</span><span class="code-line">    r1 <span class="token operator">=</span> <span class="token function">reduce</span><span class="token punctuation">(</span>store<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">    # 添加到事件队列
</span><span class="code-line">    loop <span class="token operator">=</span> asyncio<span class="token punctuation">.</span><span class="token function property-access method">get_event_loop</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">    loop<span class="token punctuation">.</span><span class="token function property-access method">run_until_complete</span><span class="token punctuation">(</span>asyncio<span class="token punctuation">.</span><span class="token function property-access method">gather</span><span class="token punctuation">(</span>a1<span class="token punctuation">,</span> a2<span class="token punctuation">,</span> r1<span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">    loop<span class="token punctuation">.</span><span class="token function property-access method">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span></code></pre></div></div><div class="pt-6 pb-6 text-sm text-gray-700 dark:text-gray-300"><a class="break-words" target="_blank" rel="nofollow" href="https://mobile.twitter.com/search?q=https%3A%2F%2Fnmwei.github.io%2Fblog%2FPython%2FPython%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8---%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86%E4%B8%8E%E5%A4%9A%E7%BA%BF%E7%A8%8B">Discuss on Twitter</a> • <a class="break-words" target="_blank" rel="noopener noreferrer" href="https://github.com/nmwei/nmwei.github.io/blob/main/data/blog/Python/Python基础入门---内存管理与多线程.mdx">View on GitHub</a></div><div class="pt-6 pb-6 text-center text-gray-700 dark:text-gray-300" id="comment"><button>Load Comments</button></div></div><footer><div class="divide-gray-200 text-sm leading-5 font-medium xl:col-start-1 xl:row-start-2 xl:divide-y dark:divide-gray-700"><div class="py-4 xl:py-8"><h2 class="text-xs tracking-wide text-gray-500 uppercase dark:text-gray-400">Tags</h2><div class="flex flex-wrap"><a class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400 mr-3 text-sm font-medium" href="/tags/python">Python</a><a class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400 mr-3 text-sm font-medium" href="/tags/后端">后端</a></div></div><div class="flex justify-between py-4 xl:block xl:space-y-8 xl:py-8"><div><h2 class="text-xs tracking-wide text-gray-500 uppercase dark:text-gray-400">Previous Article</h2><div class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400"><a class="break-words" href="/blog/Python/Python基础入门---正则表达式与综合实战">Python基础入门---正则表达式与综合实战</a></div></div><div><h2 class="text-xs tracking-wide text-gray-500 uppercase dark:text-gray-400">Next Article</h2><div class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400"><a class="break-words" href="/blog/Python/Python操作三大数据库---MySQL数据库(Part2)">Python操作三大数据库---MySQL数据库(Part2)</a></div></div></div></div><div class="pt-4 xl:pt-8"><a class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" aria-label="Back to the blog" href="/blog">← Back to the blog</a></div></footer></div></div></article></section></main><footer><div class="mt-16 flex flex-col items-center"><div class="mb-3 flex space-x-4"><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="mailto:254060001@qq.com"><span class="sr-only">mail</span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" class="hover:text-primary-500 dark:hover:text-primary-400 fill-current text-gray-700 dark:text-gray-200 h-6 w-6"><title>Mail</title><path d="M2.003 5.884L10 9.882l7.997-3.998A2 2 0 0016 4H4a2 2 0 00-1.997 1.884z"></path><path d="M18 8.118l-8 4-8-4V14a2 2 0 002 2h12a2 2 0 002-2V8.118z"></path></svg></a><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://github.com"><span class="sr-only">github</span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="hover:text-primary-500 dark:hover:text-primary-400 fill-current text-gray-700 dark:text-gray-200 h-6 w-6"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg></a></div><div class="mb-2 flex space-x-2 text-sm text-gray-500 dark:text-gray-400"><div>倪梦威</div><div> • </div><div>© 2025</div><div> • </div><a class="break-words" href="/">我的博客</a></div></div></footer></section><script src="/_next/static/chunks/webpack-af24fb31267d6e11.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[1478,[\"545\",\"static/chunks/c16f53c3-5b47b7f1ae12d8f6.js\",\"874\",\"static/chunks/874-7cca39d2e0ddd8b8.js\",\"430\",\"static/chunks/430-27ea613f983ffbaf.js\",\"177\",\"static/chunks/app/layout-4f2fc603b9b897e8.js\"],\"ThemeProviders\"]\n3:I[9243,[\"545\",\"static/chunks/c16f53c3-5b47b7f1ae12d8f6.js\",\"874\",\"static/chunks/874-7cca39d2e0ddd8b8.js\",\"430\",\"static/chunks/430-27ea613f983ffbaf.js\",\"177\",\"static/chunks/app/layout-4f2fc603b9b897e8.js\"],\"\"]\n4:I[7392,[\"545\",\"static/chunks/c16f53c3-5b47b7f1ae12d8f6.js\",\"874\",\"static/chunks/874-7cca39d2e0ddd8b8.js\",\"430\",\"static/chunks/430-27ea613f983ffbaf.js\",\"177\",\"static/chunks/app/layout-4f2fc603b9b897e8.js\"],\"KBarSearchProvider\"]\n5:I[6874,[\"874\",\"static/chunks/874-7cca39d2e0ddd8b8.js\",\"63\",\"static/chunks/63-2b4206848ffc60fb.js\",\"909\",\"static/chunks/app/blog/%5B...slug%5D/page-28d33eed3f173442.js\"],\"\"]\n6:I[4159,[\"545\",\"static/chunks/c16f53c3-5b47b7f1ae12d8f6.js\",\"874\",\"static/chunks/874-7cca39d2e0ddd8b8.js\",\"430\",\"static/chunks/430-27ea613f983ffbaf.js\",\"177\",\"static/chunks/app/layout-4f2fc603b9b897e8.js\"],\"KBarButton\"]\n7:I[1762,[\"545\",\"static/chunks/c16f53c3-5b47b7f1ae12d8f6.js\",\"874\",\"static/chunks/874-7cca39d2e0ddd8b8.js\",\"430\",\"static/chunks/430-27ea613f983ffbaf.js\",\"177\",\"static/chunks/app/layout-4f2fc603b9b897e8.js\"],\"default\"]\n8:I[7298,[\"545\",\"static/chunks/c16f53c3-5b47b7f1ae12d8f6.js\",\"874\",\"static/chunks/874-7cca39d2e0ddd8b8.js\",\"430\",\"static/chunks/430-27ea613f983ffbaf.js\",\"177\",\"static/chunks/app/layout-4f2fc603b9b897e8.js\"],\"default\"]\n9:I[7555,[],\"\"]\na:I[1295,[],\"\"]\nc:I[9665,[],\"OutletBoundary\"]\nf:I[9665,[],\"ViewportBoundary\"]\n11:I[9665,[],\"MetadataBoundary\"]\n13:I[6614,[],\"\"]\n:HL[\"/_next/static/media/7cba1811e3c25a15-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/css/f71128b9ac16cc11.css\",\"style\"]\n:HL[\"/_next/static/css/5fa3e5bae12b17db.css\",\"style\"]\n:HL[\"/_next/static/css/206c8cd9f1135cc1.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"zD_bYF5SZMVS-oUQR0xRK\",\"p\":\"\",\"c\":[\"\",\"blog\",\"Python\",\"Python%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8---%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86%E4%B8%8E%E5%A4%9A%E7%BA%BF%E7%A8%8B\"],\"i\":false,\"f\":[[[\"\",{\"children\":[\"blog\",{\"children\":[[\"slug\",\"Python/Python%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8---%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86%E4%B8%8E%E5%A4%9A%E7%BA%BF%E7%A8%8B\",\"c\"],{\"children\":[\"__PAGE__\",{}]}]}]},\"$undefined\",\"$undefined\",true],[\"\",[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/f71128b9ac16cc11.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}],[\"$\",\"link\",\"1\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/5fa3e5bae12b17db.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"zh-cn\",\"className\":\"__variable_bc0dcf scroll-smooth\",\"suppressHydrationWarning\":true,\"children\":[[\"$\",\"link\",null,{\"rel\":\"apple-touch-icon\",\"sizes\":\"76x76\",\"href\":\"/static/favicons/apple-touch-icon.png\"}],[\"$\",\"link\",null,{\"rel\":\"icon\",\"type\":\"image/png\",\"sizes\":\"32x32\",\"href\":\"/static/favicons/favicon-32x32.png\"}],[\"$\",\"link\",null,{\"rel\":\"icon\",\"type\":\"image/png\",\"sizes\":\"16x16\",\"href\":\"/static/favicons/favicon-16x16.png\"}],[\"$\",\"link\",null,{\"rel\":\"manifest\",\"href\":\"/static/favicons/site.webmanifest\"}],[\"$\",\"link\",null,{\"rel\":\"mask-icon\",\"href\":\"/static/favicons/safari-pinned-tab.svg\",\"color\":\"#5bbad5\"}],[\"$\",\"meta\",null,{\"name\":\"msapplication-TileColor\",\"content\":\"#000000\"}],[\"$\",\"meta\",null,{\"name\":\"theme-color\",\"media\":\"(prefers-color-scheme: light)\",\"content\":\"#fff\"}],[\"$\",\"meta\",null,{\"name\":\"theme-color\",\"media\":\"(prefers-color-scheme: dark)\",\"content\":\"#000\"}],[\"$\",\"link\",null,{\"rel\":\"alternate\",\"type\":\"application/rss+xml\",\"href\":\"/feed.xml\"}],[\"$\",\"body\",null,{\"className\":\"bg-white pl-[calc(100vw-100%)] text-black antialiased dark:bg-gray-950 dark:text-white\",\"children\":[\"$\",\"$L2\",null,{\"children\":[[\"$undefined\",\"$undefined\",\"$undefined\",[\"$\",\"$L3\",null,{\"async\":true,\"defer\":true,\"src\":\"https://analytics.umami.is/script.js\"}],\"$undefined\",\"$undefined\"],[\"$\",\"section\",null,{\"className\":\"mx-auto max-w-3xl px-4 sm:px-6 xl:max-w-5xl xl:px-0\",\"children\":[[\"$\",\"$L4\",null,{\"kbarConfig\":{\"searchDocumentsPath\":\"/search.json\"},\"children\":[[\"$\",\"header\",null,{\"className\":\"flex items-center w-full bg-white dark:bg-gray-950 justify-between py-10\",\"children\":[[\"$\",\"$L5\",null,{\"className\":\"break-words\",\"href\":\"/\",\"aria-label\":\"我的博客\",\"children\":[\"$\",\"div\",null,{\"className\":\"flex items-center justify-between\",\"children\":[[\"$\",\"div\",null,{\"className\":\"mr-3\",\"children\":[\"$\",\"svg\",null,{\"xmlns\":\"http://www.w3.org/2000/svg\",\"xmlnsXlink\":\"http://www.w3.org/1999/xlink\",\"width\":53.87,\"height\":43.61,\"viewBox\":\"344.564 330.278 111.737 91.218\",\"children\":[[\"$\",\"defs\",null,{\"children\":[[\"$\",\"linearGradient\",null,{\"id\":\"logo_svg__b\",\"x1\":420.97,\"x2\":420.97,\"y1\":331.28,\"y2\":418.5,\"gradientUnits\":\"userSpaceOnUse\",\"children\":[[\"$\",\"stop\",null,{\"offset\":\"0%\",\"style\":{\"stopColor\":\"#06b6d4\",\"stopOpacity\":1}}],[\"$\",\"stop\",null,{\"offset\":\"100%\",\"style\":{\"stopColor\":\"#67e8f9\",\"stopOpacity\":1}}]]}],[\"$\",\"linearGradient\",null,{\"id\":\"logo_svg__d\",\"x1\":377.89,\"x2\":377.89,\"y1\":331.28,\"y2\":418.5,\"gradientUnits\":\"userSpaceOnUse\",\"children\":[[\"$\",\"stop\",null,{\"offset\":\"0%\",\"style\":{\"stopColor\":\"#06b6d4\",\"stopOpacity\":1}}],[\"$\",\"stop\",null,{\"offset\":\"100%\",\"style\":{\"stopColor\":\"#67e8f9\",\"stopOpacity\":1}}]]}],[\"$\",\"path\",null,{\"id\":\"logo_svg__a\",\"d\":\"M453.3 331.28v28.57l-64.66 58.65v-30.08z\"}],[\"$\",\"path\",null,{\"id\":\"logo_svg__c\",\"d\":\"M410.23 331.28v28.57l-64.67 58.65v-30.08z\"}]]}],[\"$\",\"use\",null,{\"xlinkHref\":\"#logo_svg__a\",\"fill\":\"url(#logo_svg__b)\"}],[\"$\",\"use\",null,{\"xlinkHref\":\"#logo_svg__c\",\"fill\":\"url(#logo_svg__d)\"}]]}]}],[\"$\",\"div\",null,{\"className\":\"hidden h-6 text-2xl font-semibold sm:block\",\"children\":\"我的博客\"}]]}]}],[\"$\",\"div\",null,{\"className\":\"flex items-center space-x-4 leading-5 sm:-mr-6 sm:space-x-6\",\"children\":[[\"$\",\"div\",null,{\"className\":\"no-scrollbar hidden max-w-40 items-center gap-x-4 overflow-x-auto sm:flex md:max-w-72 lg:max-w-96\",\"children\":[[\"$\",\"$L5\",\"博客\",{\"className\":\"hover:text-primary-500 dark:hover:text-primary-400 m-1 font-medium text-gray-900 dark:text-gray-100\",\"href\":\"/blog\",\"children\":\"博客\"}],[\"$\",\"$L5\",\"标签\",{\"className\":\"hover:text-primary-500 dark:hover:text-primary-400 m-1 font-medium text-gray-900 dark:text-gray-100\",\"href\":\"/tags\",\"children\":\"标签\"}],[\"$\",\"$L5\",\"项目\",{\"className\":\"hover:text-primary-500 dark:hover:text-primary-400 m-1 font-medium text-gray-900 dark:text-gray-100\",\"href\":\"/projects\",\"children\":\"项目\"}],[\"$\",\"$L5\",\"关于\",{\"className\":\"hover:text-primary-500 dark:hover:text-primary-400 m-1 font-medium text-gray-900 dark:text-gray-100\",\"href\":\"/about\",\"children\":\"关于\"}]]}],[\"$\",\"$L6\",null,{\"aria-label\":\"Search\",\"children\":[\"$\",\"svg\",null,{\"xmlns\":\"http://www.w3.org/2000/svg\",\"fill\":\"none\",\"viewBox\":\"0 0 24 24\",\"strokeWidth\":1.5,\"stroke\":\"currentColor\",\"className\":\"hover:text-primary-500 dark:hover:text-primary-400 h-6 w-6 text-gray-900 dark:text-gray-100\",\"children\":[\"$\",\"path\",null,{\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"d\":\"M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z\"}]}]}],[\"$\",\"$L7\",null,{}],[\"$\",\"$L8\",null,{}]]}]]}],[\"$\",\"main\",null,{\"className\":\"mb-auto\",\"children\":[\"$\",\"$L9\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$La\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[\"$\",\"div\",null,{\"className\":\"flex flex-col items-start justify-start md:mt-24 md:flex-row md:items-center md:justify-center md:space-x-6\",\"children\":[[\"$\",\"div\",null,{\"className\":\"space-x-2 pt-6 pb-8 md:space-y-5\",\"children\":[\"$\",\"h1\",null,{\"className\":\"text-6xl leading-9 font-extrabold tracking-tight text-gray-900 md:border-r-2 md:px-6 md:text-8xl md:leading-14 dark:text-gray-100\",\"children\":\"404\"}]}],[\"$\",\"div\",null,{\"className\":\"max-w-md\",\"children\":[[\"$\",\"p\",null,{\"className\":\"mb-4 text-xl leading-normal font-bold md:text-2xl\",\"children\":\"Sorry we couldn't find this page.\"}],[\"$\",\"p\",null,{\"className\":\"mb-8\",\"children\":\"But dont worry, you can find plenty of other things on our homepage.\"}],[\"$\",\"$L5\",null,{\"className\":\"focus:shadow-outline-blue inline rounded-lg border border-transparent bg-blue-600 px-4 py-2 text-sm leading-5 font-medium text-white shadow-xs transition-colors duration-150 hover:bg-blue-700 focus:outline-hidden dark:hover:bg-blue-500\",\"href\":\"/\",\"children\":\"Back to homepage\"}]]}]]}],[]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}]]}],[\"$\",\"footer\",null,{\"children\":[\"$\",\"div\",null,{\"className\":\"mt-16 flex flex-col items-center\",\"children\":[[\"$\",\"div\",null,{\"className\":\"mb-3 flex space-x-4\",\"children\":[[\"$\",\"a\",null,{\"className\":\"text-sm text-gray-500 transition hover:text-gray-600\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"mailto:254060001@qq.com\",\"children\":[[\"$\",\"span\",null,{\"className\":\"sr-only\",\"children\":\"mail\"}],[\"$\",\"svg\",null,{\"xmlns\":\"http://www.w3.org/2000/svg\",\"viewBox\":\"0 0 20 20\",\"className\":\"hover:text-primary-500 dark:hover:text-primary-400 fill-current text-gray-700 dark:text-gray-200 h-6 w-6\",\"children\":[[\"$\",\"title\",null,{\"children\":\"Mail\"}],[\"$\",\"path\",null,{\"d\":\"M2.003 5.884L10 9.882l7.997-3.998A2 2 0 0016 4H4a2 2 0 00-1.997 1.884z\"}],[\"$\",\"path\",null,{\"d\":\"M18 8.118l-8 4-8-4V14a2 2 0 002 2h12a2 2 0 002-2V8.118z\"}]]}]]}],[\"$\",\"a\",null,{\"className\":\"text-sm text-gray-500 transition hover:text-gray-600\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://github.com\",\"children\":[[\"$\",\"span\",null,{\"className\":\"sr-only\",\"children\":\"github\"}],[\"$\",\"svg\",null,{\"xmlns\":\"http://www.w3.org/2000/svg\",\"viewBox\":\"0 0 24 24\",\"className\":\"hover:text-primary-500 dark:hover:text-primary-400 fill-current text-gray-700 dark:text-gray-200 h-6 w-6\",\"children\":[[\"$\",\"title\",null,{\"children\":\"GitHub\"}],[\"$\",\"path\",null,{\"d\":\"M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12\"}]]}]]}],null,null,null,null,null,null,null,null,null]}],[\"$\",\"div\",null,{\"className\":\"mb-2 flex space-x-2 text-sm text-gray-500 dark:text-gray-400\",\"children\":[[\"$\",\"div\",null,{\"children\":\"倪梦威\"}],[\"$\",\"div\",null,{\"children\":\" • \"}],[\"$\",\"div\",null,{\"children\":\"© 2025\"}],[\"$\",\"div\",null,{\"children\":\" • \"}],[\"$\",\"$L5\",null,{\"className\":\"break-words\",\"href\":\"/\",\"children\":\"我的博客\"}]]}],false]}]}]]}]]}]}]]}]]}],{\"children\":[\"blog\",[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L9\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$La\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[[\"slug\",\"Python/Python%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8---%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86%E4%B8%8E%E5%A4%9A%E7%BA%BF%E7%A8%8B\",\"c\"],[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L9\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$La\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[\"__PAGE__\",[\"$\",\"$1\",\"c\",{\"children\":[\"$Lb\",\"$undefined\",[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/206c8cd9f1135cc1.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"$Lc\",null,{\"children\":[\"$Ld\",\"$Le\",null]}]]}],{},null,false]},null,false]},null,false]},null,false],[\"$\",\"$1\",\"h\",{\"children\":[null,[\"$\",\"$1\",\"E70w63w8s9nriSbA1GzIl\",{\"children\":[[\"$\",\"$Lf\",null,{\"children\":\"$L10\"}],[\"$\",\"meta\",null,{\"name\":\"next-size-adjust\",\"content\":\"\"}]]}],[\"$\",\"$L11\",null,{\"children\":\"$L12\"}]]}],false]],\"m\":\"$undefined\",\"G\":[\"$13\",\"$undefined\"],\"s\":false,\"S\":true}\n"])</script><script>self.__next_f.push([1,"14:I[1839,[\"874\",\"static/chunks/874-7cca39d2e0ddd8b8.js\",\"63\",\"static/chunks/63-2b4206848ffc60fb.js\",\"909\",\"static/chunks/app/blog/%5B...slug%5D/page-28d33eed3f173442.js\"],\"default\"]\n15:I[3063,[\"874\",\"static/chunks/874-7cca39d2e0ddd8b8.js\",\"63\",\"static/chunks/63-2b4206848ffc60fb.js\",\"909\",\"static/chunks/app/blog/%5B...slug%5D/page-28d33eed3f173442.js\"],\"Image\"]\n16:I[2100,[\"874\",\"static/chunks/874-7cca39d2e0ddd8b8.js\",\"63\",\"static/chunks/63-2b4206848ffc60fb.js\",\"909\",\"static/chunks/app/blog/%5B...slug%5D/page-28d33eed3f173442.js\"],\"default\"]\n17:I[1449,[\"874\",\"static/chunks/874-7cca39d2e0ddd8b8.js\",\"63\",\"static/chunks/63-2b4206848ffc60fb.js\",\"909\",\"static/chunks/app/blog/%5B...slug%5D/page-28d33eed3f173442.js\"],\"default\"]\n"])</script><script>self.__next_f.push([1,"b:[[\"$\",\"script\",null,{\"type\":\"application/ld+json\",\"dangerouslySetInnerHTML\":{\"__html\":\"{\\\"@context\\\":\\\"https://schema.org\\\",\\\"@type\\\":\\\"BlogPosting\\\",\\\"headline\\\":\\\"Python基础入门---内存管理与多线程\\\",\\\"datePublished\\\":\\\"2019-10-17T00:00:00.000Z\\\",\\\"dateModified\\\":\\\"2019-10-17T00:00:00.000Z\\\",\\\"description\\\":\\\"Python基础入门---内存管理与多线程相关文章\\\",\\\"image\\\":\\\"/static/images/python.jpg\\\",\\\"url\\\":\\\"https://nmwei.github.io/blog/Python/Python基础入门---内存管理与多线程\\\",\\\"author\\\":[{\\\"@type\\\":\\\"Person\\\",\\\"name\\\":\\\"倪梦威\\\"}]}\"}}],[\"$\",\"section\",null,{\"className\":\"mx-auto max-w-3xl px-4 sm:px-6 xl:max-w-5xl xl:px-0\",\"children\":[[\"$\",\"$L14\",null,{}],[\"$\",\"article\",null,{\"children\":[\"$\",\"div\",null,{\"className\":\"xl:divide-y xl:divide-gray-200 xl:dark:divide-gray-700\",\"children\":[[\"$\",\"header\",null,{\"className\":\"pt-6 xl:pb-6\",\"children\":[\"$\",\"div\",null,{\"className\":\"space-y-1 text-center\",\"children\":[[\"$\",\"dl\",null,{\"className\":\"space-y-10\",\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"dt\",null,{\"className\":\"sr-only\",\"children\":\"Published on\"}],[\"$\",\"dd\",null,{\"className\":\"text-base leading-6 font-medium text-gray-500 dark:text-gray-400\",\"children\":[\"$\",\"time\",null,{\"dateTime\":\"2019-10-17T00:00:00.000Z\",\"children\":\"2019年10月17日星期四\"}]}]]}]}],[\"$\",\"div\",null,{\"children\":[\"$\",\"h1\",null,{\"className\":\"text-3xl leading-9 font-extrabold tracking-tight text-gray-900 sm:text-4xl sm:leading-10 md:text-5xl md:leading-14 dark:text-gray-100\",\"children\":\"Python基础入门---内存管理与多线程\"}]}]]}]}],[\"$\",\"div\",null,{\"className\":\"grid-rows-[auto_1fr] divide-y divide-gray-200 pb-8 xl:grid xl:grid-cols-4 xl:gap-x-6 xl:divide-y-0 dark:divide-gray-700\",\"children\":[[\"$\",\"dl\",null,{\"className\":\"pt-6 pb-10 xl:border-b xl:border-gray-200 xl:pt-11 xl:dark:border-gray-700\",\"children\":[[\"$\",\"dt\",null,{\"className\":\"sr-only\",\"children\":\"Authors\"}],[\"$\",\"dd\",null,{\"children\":[\"$\",\"ul\",null,{\"className\":\"flex flex-wrap justify-center gap-4 sm:space-x-12 xl:block xl:space-y-8 xl:space-x-0\",\"children\":[[\"$\",\"li\",\"倪梦威\",{\"className\":\"flex items-center space-x-2\",\"children\":[[\"$\",\"$L15\",null,{\"src\":\"/static/images/avatar.png\",\"width\":38,\"height\":38,\"alt\":\"avatar\",\"className\":\"h-10 w-10 rounded-full\"}],[\"$\",\"dl\",null,{\"className\":\"text-sm leading-5 font-medium whitespace-nowrap\",\"children\":[[\"$\",\"dt\",null,{\"className\":\"sr-only\",\"children\":\"Name\"}],[\"$\",\"dd\",null,{\"className\":\"text-gray-900 dark:text-gray-100\",\"children\":\"倪梦威\"}],[\"$\",\"dt\",null,{\"className\":\"sr-only\",\"children\":\"Twitter\"}],[\"$\",\"dd\",null,{\"children\":null}]]}]]}]]}]}]]}],[\"$\",\"div\",null,{\"className\":\"divide-y divide-gray-200 xl:col-span-3 xl:row-span-2 xl:pb-0 dark:divide-gray-700\",\"children\":[[\"$\",\"div\",null,{\"className\":\"prose dark:prose-invert max-w-none pt-10 pb-8\",\"children\":[[\"$\",\"h1\",null,{\"className\":\"content-header\",\"id\":\"1-内存管理机制\",\"children\":[[\"$\",\"a\",null,{\"className\":\"break-words\",\"href\":\"#1-内存管理机制\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"1. 内存管理机制\"]}],[\"$\",\"h2\",null,{\"className\":\"content-header\",\"id\":\"11-介绍\",\"children\":[[\"$\",\"a\",null,{\"className\":\"break-words\",\"href\":\"#11-介绍\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"1.1 介绍\"]}],[\"$\",\"ol\",null,{\"children\":[[\"$\",\"li\",null,{\"children\":\"概要 赋值语句内存分析 垃圾回收机制 内存管理机制\"}],[\"$\",\"li\",null,{\"children\":[\"目标 掌握赋值语句内存分析方法 掌握\",[\"$\",\"code\",null,{\"children\":\"id()\"}],\"和\",[\"$\",\"code\",null,{\"children\":\"is\"}],\"的使用 了解\",[\"$\",\"code\",null,{\"children\":\"Python\"}],\"的垃圾回收机制 了解\",[\"$\",\"code\",null,{\"children\":\"Python\"}],\"的内存管理机制\"]}],[\"$\",\"li\",null,{\"children\":\"内存与硬盘 内存是电脑的数据存储设备之一，其特点为容量较小，但数据传送速度较快，用以弥补硬盘虽然容量大但传送速度慢的缺点。\"}]]}],[\"$\",\"h2\",null,{\"className\":\"content-header\",\"id\":\"12-内存管理机制\",\"children\":[[\"$\",\"a\",null,{\"className\":\"break-words\",\"href\":\"#12-内存管理机制\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"1.2 内存管理机制\"]}],[\"$\",\"ol\",null,{\"children\":[\"$\",\"li\",null,{\"children\":[[\"$\",\"code\",null,{\"children\":\"is\"}],\"、\",[\"$\",\"code\",null,{\"children\":\"id()\"}],\"和\",[\"$\",\"code\",null,{\"children\":\"==\"}],\" \",[\"$\",\"code\",null,{\"children\":\"a is b\"}],\"等价于\",[\"$\",\"code\",null,{\"children\":\"id(a) == id(b)\"}],\"，比较的是\",[\"$\",\"code\",null,{\"children\":\"id\"}],\"(内存标识)是否相同。 \",[\"$\",\"code\",null,{\"children\":\"a == b\"}],\"比较的是\",[\"$\",\"code\",null,{\"children\":\"value\"}],\"(值)是否相同。\"]}]}],[\"$\",\"$L16\",null,{\"className\":\"language-js\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-js code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"a1 \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"5\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"a2 \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"5\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"print\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"id\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"a1\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"  # \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"4313714912\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"print\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"id\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"a1\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"==\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"id\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"a2\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" a1 is a2\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"  # \",[\"$\",\"span\",null,{\"className\":\"token maybe-class-name\",\"children\":\"True\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token maybe-class-name\",\"children\":\"True\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"b1 \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'abc'\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"b2 \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'abc'\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"print\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"b1 \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"==\"}],\" b2\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" b1 is b2\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"  # \",[\"$\",\"span\",null,{\"className\":\"token maybe-class-name\",\"children\":\"True\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token maybe-class-name\",\"children\":\"True\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"c1 \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"[\"}],[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"1\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"]\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"c2 \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"[\"}],[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"1\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"]\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"print\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"c1 \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"==\"}],\" c2\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" c1 is c2\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"  # \",[\"$\",\"span\",null,{\"className\":\"token maybe-class-name\",\"children\":\"True\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token maybe-class-name\",\"children\":\"False\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"d1 \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],[\"$\",\"span\",null,{\"className\":\"token property string-property\",\"children\":\"'a'\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"1\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"d2 \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],[\"$\",\"span\",null,{\"className\":\"token property string-property\",\"children\":\"'a'\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"1\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"print\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"d1 \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"==\"}],\" d2\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" d1 is d2\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"  # \",[\"$\",\"span\",null,{\"className\":\"token maybe-class-name\",\"children\":\"True\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token maybe-class-name\",\"children\":\"False\"}],\"\\n\"]}]]}]}],[\"$\",\"ol\",null,{\"start\":\"2\",\"children\":[\"$\",\"li\",null,{\"children\":\"内存管理示例\"}]}],[\"$\",\"$L16\",null,{\"className\":\"language-js\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-js code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"def \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"extend_list\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"value\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" list\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"[\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"]\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    list\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"append\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"value\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword control-flow\",\"children\":\"return\"}],\" list\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"l1 \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"extend_list\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"10\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"l2 \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"extend_list\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"123\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"[\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"]\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"l3 \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"extend_list\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'a'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"print\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"l1\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"  # \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"[\"}],[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"10\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'a'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"]\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"print\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"l2\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"  # \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"[\"}],[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"123\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"]\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"print\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"l3\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"  # \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"[\"}],[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"10\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'a'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"]\"}],\"\\n\"]}]]}]}],[\"$\",\"ol\",null,{\"start\":\"3\",\"children\":[\"$\",\"li\",null,{\"children\":\"垃圾回收机制 以引用计数为主，分代收集为辅。\"}]}],[\"$\",\"$L16\",null,{\"className\":\"language-js\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-js code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"class\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":\"Cat\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"object\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    def \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"__init__\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"self\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"print\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'{} init'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"format\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"id\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"self\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    def \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"__del__\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"self\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"print\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'{} del'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"format\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"id\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"self\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword control-flow\",\"children\":\"while\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token property literal-property\",\"children\":\"True\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\" 自动回收内存 \\\"\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"\\\"\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    c1 \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":[\"$\",\"span\",null,{\"className\":\"token maybe-class-name\",\"children\":\"Cat\"}]}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"l \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"[\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"]\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword control-flow\",\"children\":\"while\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token property literal-property\",\"children\":\"True\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\" 一直被引用，内存不会释放 \\\"\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"\\\"\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    c1 \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":[\"$\",\"span\",null,{\"className\":\"token maybe-class-name\",\"children\":\"Cat\"}]}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    l\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"append\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"c1\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}]]}]}],[\"$\",\"p\",null,{\"children\":[\"注意：在引用计数垃圾回收机制中，循环引用会导致内存泄漏。 4. 引用计数 每个对象都存在指向该对象的引用计数。 查看某个对象的引用计数：\",[\"$\",\"code\",null,{\"children\":\"sys.getrefcount()\"}],\" 删除某个引用： \",[\"$\",\"code\",null,{\"children\":\"del\"}]]}],[\"$\",\"$L16\",null,{\"className\":\"language-js\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-js code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword module\",\"children\":\"import\"}],\" sys\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"# 基本数据类型\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"i \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"1\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"print\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"sys\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"getrefcount\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"i\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"  # \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"181\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"i1 \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"1\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"i2 \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" i1\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"print\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"sys\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"getrefcount\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"i\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"  # \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"183\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"del i1\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"print\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"sys\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"getrefcount\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"i\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"  # \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"182\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"# 引用数据类型\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"l \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"[\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"]\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"print\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"sys\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"getrefcount\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"l\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"   # \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"2\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"l1 \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" l\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"l2 \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" l1\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"print\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"sys\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"getrefcount\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"l\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"  # \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"4\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"del l2\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"print\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"sys\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"getrefcount\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"l\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"  # \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"3\"}],\"\\n\"]}]]}]}],[\"$\",\"ol\",null,{\"start\":\"5\",\"children\":[[\"$\",\"li\",null,{\"children\":[\"分代收集 \",[\"$\",\"code\",null,{\"children\":\"Python\"}],\"将所有的对象分为\",[\"$\",\"code\",null,{\"children\":\"0\"}],\"，\",[\"$\",\"code\",null,{\"children\":\"1\"}],\"，\",[\"$\",\"code\",null,{\"children\":\"2\"}],\"三代。 所有新建对象都是\",[\"$\",\"code\",null,{\"children\":\"0\"}],\"代对象。 当某一代对象经历过垃圾回收，依然存活，那么它就被归入下一代对象。\"]}],[\"$\",\"li\",null,{\"children\":[\"垃圾回收时机 当\",[\"$\",\"code\",null,{\"children\":\"Python\"}],\"运行时，会记录其中分配对象(\",[\"$\",\"code\",null,{\"children\":\"object allocation\"}],\")和取消分配对象(\",[\"$\",\"code\",null,{\"children\":\"object deallocation\"}],\")的次数。当两者的差值高于某一个阈值时，垃圾回收才会启动。 查看阈值：\",[\"$\",\"code\",null,{\"children\":\"gc.get_threshold()\"}]]}]]}],[\"$\",\"$L16\",null,{\"className\":\"language-js\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-js code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword module\",\"children\":\"import\"}],\" gc\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"print\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"gc\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"get_threshold\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"  # \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"700\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"10\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"10\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" 依次表示第\",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"0\"}],\"、\",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"1\"}],\"、\",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"2\"}],\"代垃圾回收阈值\\n\"]}]]}]}],[\"$\",\"ol\",null,{\"start\":\"7\",\"children\":[\"$\",\"li\",null,{\"children\":[\"手动回收 \",[\"$\",\"code\",null,{\"children\":\"gc.collect()\"}],\"手动回收。 \",[\"$\",\"code\",null,{\"children\":\"objgraph\"}],\"模块中的\",[\"$\",\"code\",null,{\"children\":\"count()\"}],\"可以记录当前类产生的未回收实例对象个数。\"]}]}],[\"$\",\"$L16\",null,{\"className\":\"language-js\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-js code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"class\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":\"Person\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"object\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"    pass\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"class\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":\"Cat\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"object\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"    pass\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"p \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":[\"$\",\"span\",null,{\"className\":\"token maybe-class-name\",\"children\":\"Person\"}]}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"c \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":[\"$\",\"span\",null,{\"className\":\"token maybe-class-name\",\"children\":\"Cat\"}]}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"p\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":\"pet\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" c\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"c\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":\"master\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" p\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"print\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"sys\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"getrefcount\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"p\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"  # \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"3\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"print\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"sys\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"getrefcount\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"c\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"  # \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"3\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"print\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"objgraph\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"count\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'Person'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"  # \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"1\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"print\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"objgraph\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"count\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'Cat'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"  # \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"1\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"del p\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"del c\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"gc\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"collect\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"  # p与c循环引用。如果不使用del，则无法回收。\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"print\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"objgraph\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"count\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'Person'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"  # \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"0\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"print\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"objgraph\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"count\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'Cat'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"  # \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"0\"}],\"\\n\"]}]]}]}],[\"$\",\"ol\",null,{\"start\":\"8\",\"children\":[\"$\",\"li\",null,{\"children\":[\"内存池(\",[\"$\",\"code\",null,{\"children\":\"memory pool\"}],\")机制 当创建大量小内存对象时，频繁调用\",[\"$\",\"code\",null,{\"children\":\"new / malloc\"}],\"会导致大量内存碎片，效率降低。内存池就是预先在内存中申请一定数量的、大小相等的内存块留作备用，当有新的内存需求时，就先从内存池中分配内存给这个需求，不够了再申请新的内存。这样做可以减少内存碎片，提高效率。 \",[\"$\",\"code\",null,{\"children\":\"Python3\"}],\"中的内存管理机制——\",[\"$\",\"code\",null,{\"children\":\"Pymalloc\"}],\" 针对小对象(\",[\"$\",\"code\",null,{\"children\":\"\u003c=512bytes\"}],\")，\",[\"$\",\"code\",null,{\"children\":\"pymalloc\"}],\"会在内存池中申请内存空间。 当内存\",[\"$\",\"code\",null,{\"children\":\"\u003e512bytes\"}],\"时，则使用\",[\"$\",\"code\",null,{\"children\":\"PyMen_RawMalloc()\"}],\"和\",[\"$\",\"code\",null,{\"children\":\"PyMem_RawRealloc()\"}],\"来申请新的内存空间。 注释：\",[\"$\",\"code\",null,{\"children\":\"1 Byte = 8 Bits\"}],\"(即\",[\"$\",\"code\",null,{\"children\":\"1B = 8b\"}],\")\"]}]}],[\"$\",\"h2\",null,{\"className\":\"content-header\",\"id\":\"13-总结\",\"children\":[[\"$\",\"a\",null,{\"className\":\"break-words\",\"href\":\"#13-总结\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"1.3 总结\"]}],[\"$\",\"ol\",null,{\"children\":[[\"$\",\"li\",null,{\"children\":[\"赋值语句内存分析 使用\",[\"$\",\"code\",null,{\"children\":\"id()\"}],\"方法访问内存地址 使用\",[\"$\",\"code\",null,{\"children\":\"is\"}],\"比较内存地址是否相同\"]}],[\"$\",\"li\",null,{\"children\":\"垃圾回收机制 引用计数为主，分代收集为辅 引用计数的缺陷是循环引用问题\"}],[\"$\",\"li\",null,{\"children\":[\"内存管理机制 内存池(\",[\"$\",\"code\",null,{\"children\":\"memory pool\"}],\")机制\"]}]]}],[\"$\",\"h1\",null,{\"className\":\"content-header\",\"id\":\"2-线程进程协程\",\"children\":[[\"$\",\"a\",null,{\"className\":\"break-words\",\"href\":\"#2-线程进程协程\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"2. 线程、进程、协程\"]}],[\"$\",\"h2\",null,{\"className\":\"content-header\",\"id\":\"21-介绍\",\"children\":[[\"$\",\"a\",null,{\"className\":\"break-words\",\"href\":\"#21-介绍\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"2.1 介绍\"]}],[\"$\",\"ol\",null,{\"children\":[[\"$\",\"li\",null,{\"children\":\"章节概要 进程、线程与并发 对多核的利用 实现一个线程 线程之间的通信 线程的调度和优化\"}],[\"$\",\"li\",null,{\"children\":[\"使用场景 快速高效的爬虫程序 多用户同时访问\",[\"$\",\"code\",null,{\"children\":\"Web\"}],\"服务 电商秒杀、抢购活动 物联网传感器监控服务\"]}]]}],[\"$\",\"h2\",null,{\"className\":\"content-header\",\"id\":\"22-线程\",\"children\":[[\"$\",\"a\",null,{\"className\":\"break-words\",\"href\":\"#22-线程\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"2.2 线程\"]}],[\"$\",\"ol\",null,{\"children\":[[\"$\",\"li\",null,{\"children\":[\"线程介绍 在同一个进程下执行，并共享相同的上下文。 一个进程中的各个线程与主线程共享\",[\"$\",\"strong\",null,{\"children\":\"同一片\"}],\"数据空间。 线程包括开始、执行顺序和结束三部分。 线程可以被强占(中断)和临时挂起(睡眠)——让步\"]}],[\"$\",\"li\",null,{\"children\":[\"多核的利用 单核\",[\"$\",\"code\",null,{\"children\":\"CPU\"}],\"系统中，不存在真正的并发。 \",[\"$\",\"code\",null,{\"children\":\"GIL\"}],\"全局解释器锁 - 强制在任何时候只有一个线程可以执行\",[\"$\",\"code\",null,{\"children\":\"Python\"}],\"代码。 \",[\"$\",\"code\",null,{\"children\":\"I/O\"}],\"密集型应用与\",[\"$\",\"code\",null,{\"children\":\"CPU\"}],\"密集型应用。\"]}],[\"$\",\"li\",null,{\"children\":[[\"$\",\"code\",null,{\"children\":\"GIL\"}],\"执行顺序 (1) 设置\",[\"$\",\"code\",null,{\"children\":\"GIL\"}],\" (2) 切换进一个线程去执行 (3) 执行下面操作之一 指定数量的字节码指令； 线程主动让出控制权(可以调用\",[\"$\",\"code\",null,{\"children\":\"time.sleep(0)\"}],\"来完成)。 (4) 把线程设置回睡眠状态(切换出线程) (5) 解锁\",[\"$\",\"code\",null,{\"children\":\"GIL\"}],\" (6) 重复上述步骤\"]}],[\"$\",\"li\",null,{\"children\":[[\"$\",\"code\",null,{\"children\":\"threading\"}],\"模块对象 \",[\"$\",\"img\",null,{\"alt\":\"threading模块对象\",\"src\":\"https://upload-images.jianshu.io/upload_images/4989175-8894d3b0e01adaa9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240\"}]]}],[\"$\",\"li\",null,{\"children\":[[\"$\",\"code\",null,{\"children\":\"Thread\"}],\"对象方法 \",[\"$\",\"img\",null,{\"alt\":\"Thread对象方法\",\"src\":\"https://upload-images.jianshu.io/upload_images/4989175-ea3ff3e091d9504b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240\"}]]}],[\"$\",\"li\",null,{\"children\":\"线程实现(面向过程)\"}]]}],[\"$\",\"$L16\",null,{\"className\":\"language-js\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-js code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword module\",\"children\":\"import\"}],\" threading\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword module\",\"children\":\"import\"}],\" time\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"def \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"loop\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\" 新的线程执行的代码  \\\"\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"\\\"\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    loop_thread \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" threading\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"current_thread\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"print\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'loop_thread: {}'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"format\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"loop_thread\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":\"name\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"  # loop_thread\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" loop_thread\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    n \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"0\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword control-flow\",\"children\":\"while\"}],\" n \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u003c\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"5\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"print\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"n\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"  # \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"0\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"1\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"2\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"3\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"4\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        n \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"+=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"1\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"def \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"use_thread\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\" 新的线程执行函数 \\\"\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"\\\"\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    now_thread \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" threading\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"current_thread\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"print\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'now_thread: {}'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"format\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"now_thread\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":\"name\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"  # now_thread\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token maybe-class-name\",\"children\":\"MainThread\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"    # 创建线程\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    t \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" threading\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":[\"$\",\"span\",null,{\"className\":\"token maybe-class-name\",\"children\":\"Thread\"}]}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"target\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\"loop\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" name\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'loop_thread'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"    # 启动线程\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    t\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"start\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"    # 挂起线程\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    t\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"join\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword control-flow\",\"children\":\"if\"}],\" __name__ \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"==\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'__main__'\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"use_thread\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}]]}]}],[\"$\",\"ol\",null,{\"start\":\"7\",\"children\":[\"$\",\"li\",null,{\"children\":\"线程实现(面向对象)\"}]}],[\"$\",\"$L16\",null,{\"className\":\"language-js\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-js code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword module\",\"children\":\"import\"}],\" threading\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"class\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":\"LoopThread\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"threading\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":[\"$\",\"span\",null,{\"className\":\"token maybe-class-name\",\"children\":\"Thread\"}]}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\" 自定义线程 \\\"\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"\\\"\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    n \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"0\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    def \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"run\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"self\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        loop_thread \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" threading\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"current_thread\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"print\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'loop_thread: {}'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"format\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"loop_thread\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":\"name\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"  # loop_thread\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" loop_thread\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token keyword control-flow\",\"children\":\"while\"}],\" self\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":\"n\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u003c\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"5\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"            \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"print\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"self\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":\"n\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"  # \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"0\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"1\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"2\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"3\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"4\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"            self\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":\"n\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"+=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"1\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword control-flow\",\"children\":\"if\"}],\" __name__ \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"==\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'__main__'\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    now_thread \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" threading\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"current_thread\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"print\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'now_thread: {}'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"format\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"now_thread\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":\"name\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"  # now_thread\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token maybe-class-name\",\"children\":\"MainThread\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"    # 创建线程\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    t \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":[\"$\",\"span\",null,{\"className\":\"token maybe-class-name\",\"children\":\"LoopThread\"}]}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"name\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'loop_thread'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"    # 启动线程\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    t\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"start\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"    # 挂起线程\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    t\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"join\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}]]}]}],[\"$\",\"ol\",null,{\"start\":\"8\",\"children\":[\"$\",\"li\",null,{\"children\":\"多线程及存在的问题\"}]}],[\"$\",\"$L16\",null,{\"className\":\"language-js\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-js code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword module\",\"children\":\"import\"}],\" threading\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"# 我的银行账户\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"balance \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"0\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"def \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"change\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"n\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"    global balance  # 局部作用域如果要修改全局变量，则需要global关键字声明。\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    balance \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" balance \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"+\"}],\" n\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    balance \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" balance \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"-\"}],\" n\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword control-flow\",\"children\":\"if\"}],\" balance \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"!=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"0\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"print\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"balance\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" # balance有可能是\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"-\"}],[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"8\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"-\"}],[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"5\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"0\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"5\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"8\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"class\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":\"ChangeBalanceThread\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"threading\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":[\"$\",\"span\",null,{\"className\":\"token maybe-class-name\",\"children\":\"Thread\"}]}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    def \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"__init__\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"self\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" num\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],\"args\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"**\"}],\"kwargs\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"super\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"__init__\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],\"args\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"**\"}],\"kwargs\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        self\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":\"num\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" num\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    def \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"run\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"self\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token keyword control-flow\",\"children\":\"for\"}],\" i \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"in\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"range\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"100000\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"            \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"change\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"self\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":\"num\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword control-flow\",\"children\":\"if\"}],\" __name__ \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"==\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'__main__'\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"    # 创建线程\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    t1 \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":[\"$\",\"span\",null,{\"className\":\"token maybe-class-name\",\"children\":\"ChangeBalanceThread\"}]}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"5\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    t2 \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":[\"$\",\"span\",null,{\"className\":\"token maybe-class-name\",\"children\":\"ChangeBalanceThread\"}]}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"8\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"    # 启动线程\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    t1\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"start\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    t2\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"start\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"    # 挂起线程\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    t1\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"join\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    t2\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"join\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}]]}]}],[\"$\",\"p\",null,{\"children\":[\"注意：局部作用域如果要修改全局变量，则需要\",[\"$\",\"code\",null,{\"children\":\"global\"}],\"关键字声明。 9. 锁\"]}],[\"$\",\"$L16\",null,{\"className\":\"language-js\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-js code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword module\",\"children\":\"import\"}],\" threading\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"# 锁\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"my_lock \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" threading\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":[\"$\",\"span\",null,{\"className\":\"token maybe-class-name\",\"children\":\"Lock\"}]}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"# 我的银行账户\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"balance \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"0\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"def \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"change\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"n\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"    global balance  # 局部作用域如果要修改全局变量，则需要global关键字声明。\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"    # 添加锁\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    my_lock\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"acquire\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword control-flow\",\"children\":\"try\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        balance \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" balance \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"+\"}],\" n\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        balance \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" balance \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"-\"}],\" n\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token keyword control-flow\",\"children\":\"if\"}],\" balance \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"!=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"0\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"            \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"print\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"balance\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword control-flow\",\"children\":\"finally\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"        # 释放锁\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        my_lock\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"release\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"class\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":\"ChangeBalanceThread\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"threading\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":[\"$\",\"span\",null,{\"className\":\"token maybe-class-name\",\"children\":\"Thread\"}]}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    def \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"__init__\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"self\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" num\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],\"args\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"**\"}],\"kwargs\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"super\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"__init__\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],\"args\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"**\"}],\"kwargs\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        self\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":\"num\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" num\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    def \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"run\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"self\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token keyword control-flow\",\"children\":\"for\"}],\" i \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"in\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"range\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"100000\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"            \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"change\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"self\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":\"num\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword control-flow\",\"children\":\"if\"}],\" __name__ \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"==\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'__main__'\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"    # 创建线程\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    t1 \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":[\"$\",\"span\",null,{\"className\":\"token maybe-class-name\",\"children\":\"ChangeBalanceThread\"}]}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"5\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    t2 \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":[\"$\",\"span\",null,{\"className\":\"token maybe-class-name\",\"children\":\"ChangeBalanceThread\"}]}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"8\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"    # 启动线程\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    t1\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"start\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    t2\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"start\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"    # 挂起线程\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    t1\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"join\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    t2\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"join\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}]]}]}],[\"$\",\"ol\",null,{\"start\":\"10\",\"children\":[\"$\",\"li\",null,{\"children\":\"锁的简单写法\"}]}],[\"$\",\"$L16\",null,{\"className\":\"language-js\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-js code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"# 锁\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"my_lock \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" threading\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":[\"$\",\"span\",null,{\"className\":\"token maybe-class-name\",\"children\":\"Lock\"}]}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"# 我的银行账户\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"balance \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"0\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"def \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"change\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"n\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"    global balance \\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"    # 添加锁\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"with\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token property literal-property\",\"children\":\"my_lock\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        balance \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" balance \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"+\"}],\" n\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        balance \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" balance \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"-\"}],\" n\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token keyword control-flow\",\"children\":\"if\"}],\" balance \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"!=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"0\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"            \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"print\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"balance\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}]]}]}],[\"$\",\"ol\",null,{\"start\":\"11\",\"children\":[\"$\",\"li\",null,{\"children\":\"死锁\"}]}],[\"$\",\"$L16\",null,{\"className\":\"language-js\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-js code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"# 锁\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"my_lock \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" threading\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":[\"$\",\"span\",null,{\"className\":\"token maybe-class-name\",\"children\":\"Lock\"}]}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"# 我的银行账户\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"balance \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"0\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"def \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"change\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"n\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"    global balance\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"    # 添加锁\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    my_lock\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"acquire\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    my_lock\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"acquire\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword control-flow\",\"children\":\"try\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        balance \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" balance \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"+\"}],\" n\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        balance \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" balance \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"-\"}],\" n\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"print\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"balance\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword control-flow\",\"children\":\"finally\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"        # 释放锁\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        my_lock\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"release\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        my_lock\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"release\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}]]}]}],[\"$\",\"ol\",null,{\"start\":\"12\",\"children\":[\"$\",\"li\",null,{\"children\":[[\"$\",\"code\",null,{\"children\":\"threading.RLock\"}],\" 我们使用\",[\"$\",\"code\",null,{\"children\":\"threading.Lock()\"}],\"来进行加锁。\",[\"$\",\"code\",null,{\"children\":\"threading\"}],\"中还提供了另外一个\",[\"$\",\"code\",null,{\"children\":\"threading.RLock()\"}],\"锁。在同一线程内，对\",[\"$\",\"code\",null,{\"children\":\"RLock\"}],\"进行多次\",[\"$\",\"code\",null,{\"children\":\"acquire()\"}],\"操作，程序不会阻塞。\"]}]}],[\"$\",\"$L16\",null,{\"className\":\"language-js\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-js code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"# 锁\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"my_lock \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" threading\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":[\"$\",\"span\",null,{\"className\":\"token maybe-class-name\",\"children\":\"RLock\"}]}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"# 我的银行账户\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"balance \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"0\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"def \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"change\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"n\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"    global balance  # 局部作用域如果要修改全局变量，则需要global关键字声明。\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"    # 添加锁\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    my_lock\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"acquire\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    my_lock\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"acquire\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword control-flow\",\"children\":\"try\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        balance \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" balance \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"+\"}],\" n\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        balance \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" balance \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"-\"}],\" n\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"print\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"balance\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword control-flow\",\"children\":\"finally\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"        # 释放锁\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        my_lock\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"release\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        my_lock\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"release\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}]]}]}],[\"$\",\"ol\",null,{\"start\":\"13\",\"children\":[\"$\",\"li\",null,{\"children\":\"使用线程池\"}]}],[\"$\",\"$L16\",null,{\"className\":\"language-js\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-js code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword module\",\"children\":\"import\"}],\" time\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword module\",\"children\":\"import\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token imports\",\"children\":\"threading\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword module\",\"children\":\"from\"}],\" concurrent\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":\"futures\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":\"thread\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword module\",\"children\":\"import\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token imports\",\"children\":[\"$\",\"span\",null,{\"className\":\"token maybe-class-name\",\"children\":\"ThreadPoolExecutor\"}]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword module\",\"children\":\"from\"}],\" multiprocessing\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":\"dummy\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword module\",\"children\":\"import\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token maybe-class-name\",\"children\":\"Pool\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"def \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"run\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"n\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\" 线程要做的事情 \\\"\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"\\\"\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    time\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"sleep\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"1\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"print\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'thread: {}; n: {}'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"format\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"threading\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"current_thread\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":\"name\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" n\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"def \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"main\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\" 主线程做任务 \\\"\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"\\\"\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    t1 \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" time\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"time\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword control-flow\",\"children\":\"for\"}],\" n \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"in\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"range\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"100\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"run\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"n\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"print\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"time\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"time\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"-\"}],\" t1\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"  # \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"100\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"30s\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"def \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"main_use_thread\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\" 多线程做任务。10个线程。\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"\\\"\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    t2 \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" time\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"time\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    ls \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"[\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"]\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword control-flow\",\"children\":\"for\"}],\" i \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"in\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"range\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"100\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        t \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" threading\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":[\"$\",\"span\",null,{\"className\":\"token maybe-class-name\",\"children\":\"Thread\"}]}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"target\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\"run\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" args\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"i\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        ls\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"append\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"t\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        t\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"start\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword control-flow\",\"children\":\"for\"}],\" l \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"in\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token property literal-property\",\"children\":\"ls\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        l\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"join\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"print\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"time\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"time\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"-\"}],\" t2\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"  # \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"1\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"01s\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"def \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"main_use_pool\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\" 线程池 \\\"\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"\\\"\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    t3 \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" time\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"time\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    pool \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":[\"$\",\"span\",null,{\"className\":\"token maybe-class-name\",\"children\":\"Pool\"}]}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"10\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    n_list \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"range\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"100\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    pool\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"map\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"run\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" n_list\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    pool\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"close\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    pool\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"join\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"print\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"time\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"time\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"-\"}],\" t3\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"  # \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"12\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"08s\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"def \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"main_use_executor\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\" 使用ThreadPoolExecutor来优化 \\\"\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"\\\"\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    t4 \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" time\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"time\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    n_list \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"range\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"100\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"with\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":[\"$\",\"span\",null,{\"className\":\"token maybe-class-name\",\"children\":\"ThreadPoolExecutor\"}]}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"max_workers\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"10\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword module\",\"children\":\"as\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token property literal-property\",\"children\":\"executor\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        executor\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"map\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"run\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" n_list\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"print\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"time\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"time\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"-\"}],\" t4\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"  # \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"10\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"03s\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword control-flow\",\"children\":\"if\"}],\" __name__ \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"==\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'__main__'\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"main\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"main_use_thread\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"main_use_pool\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"main_use_executor\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}]]}]}],[\"$\",\"p\",null,{\"children\":[\"注意：线程传参的方式\",[\"$\",\"code\",null,{\"children\":\"threading.Thread(target=run, args=(i,))\"}],\"。其中，\",[\"$\",\"code\",null,{\"children\":\"(i,)\"}],\"表示元组。\"]}],[\"$\",\"h2\",null,{\"className\":\"content-header\",\"id\":\"23-进程\",\"children\":[[\"$\",\"a\",null,{\"className\":\"break-words\",\"href\":\"#23-进程\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"2.3 进程\"]}],[\"$\",\"ol\",null,{\"children\":[[\"$\",\"li\",null,{\"children\":[\"进程介绍 是一个执行中的程序。 每个进程都拥有\",[\"$\",\"strong\",null,{\"children\":\"自己的\"}],\"地址空间、内存、数据栈以及其他用于跟踪执行的辅助数据。 操作系统管理所有进程的执行，并为这些进程合理地分配时间。 进程也可通过派生(\",[\"$\",\"code\",null,{\"children\":\"fork\"}],\"或\",[\"$\",\"code\",null,{\"children\":\"spawn\"}],\")新的进程来执行其他任务。\"]}],[\"$\",\"li\",null,{\"children\":\"进程实现(面向过程)\"}]]}],[\"$\",\"$L16\",null,{\"className\":\"language-js\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-js code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword module\",\"children\":\"import\"}],\" os\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword module\",\"children\":\"import\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token imports\",\"children\":\"time\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword module\",\"children\":\"from\"}],\" multiprocessing \",[\"$\",\"span\",null,{\"className\":\"token keyword module\",\"children\":\"import\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token maybe-class-name\",\"children\":\"Process\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"def \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"do_sth\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"name\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"print\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"进程名称: {}, pid: {}\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"format\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"name\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" os\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"getpid\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"  # 进程名称\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" my_process\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token property literal-property\",\"children\":\"pid\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"47634\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    time\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"sleep\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"3\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"print\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"进程要做的事情结束\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"  # 进程要做的事情结束\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword control-flow\",\"children\":\"if\"}],\" __name__ \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"==\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'__main__'\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"print\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'当前进程pid: {}'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"format\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"os\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"getpid\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"  # 当前进程名称\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"47651\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    p \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":[\"$\",\"span\",null,{\"className\":\"token maybe-class-name\",\"children\":\"Process\"}]}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"target\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\"do_sth\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" args\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'my_process'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"    # 启动进程\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    p\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"start\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"    # 挂起进程\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    p\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"join\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}]]}]}],[\"$\",\"ol\",null,{\"start\":\"3\",\"children\":[\"$\",\"li\",null,{\"children\":\"进程实现(面向对象)\"}]}],[\"$\",\"$L16\",null,{\"className\":\"language-js\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-js code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword module\",\"children\":\"import\"}],\" os\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword module\",\"children\":\"import\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token imports\",\"children\":\"time\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword module\",\"children\":\"from\"}],\" multiprocessing \",[\"$\",\"span\",null,{\"className\":\"token keyword module\",\"children\":\"import\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token maybe-class-name\",\"children\":\"Process\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"class\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":\"MyProcess\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token maybe-class-name\",\"children\":\"Process\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    def \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"run\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"self\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"print\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"进程名称: {}, pid: {}\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"format\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"self\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":\"name\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" os\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"getpid\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"  # 进程名称\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" my_process\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token property literal-property\",\"children\":\"pid\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"47758\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        time\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"sleep\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"3\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"print\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"进程要做的事情结束\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"  # 进程要做的事情结束\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword control-flow\",\"children\":\"if\"}],\" __name__ \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"==\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'__main__'\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"print\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'当前进程pid: {}'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"format\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"os\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"getpid\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"  # 当前进程名称\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"47757\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    p \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":[\"$\",\"span\",null,{\"className\":\"token maybe-class-name\",\"children\":\"MyProcess\"}]}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"name\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'my_process'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"    # 启动进程\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    p\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"start\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"    # 挂起进程\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    p\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"join\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}]]}]}],[\"$\",\"ol\",null,{\"start\":\"4\",\"children\":[\"$\",\"li\",null,{\"children\":[\"进程之间通信 通过\",[\"$\",\"code\",null,{\"children\":\"Queue\"}],\"、\",[\"$\",\"code\",null,{\"children\":\"Pipes\"}],\"等实现进程之间的通信。\"]}]}],[\"$\",\"$L16\",null,{\"className\":\"language-js\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-js code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword module\",\"children\":\"import\"}],\" time\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword module\",\"children\":\"import\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token imports\",\"children\":\"random\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword module\",\"children\":\"from\"}],\" multiprocessing \",[\"$\",\"span\",null,{\"className\":\"token keyword module\",\"children\":\"import\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token maybe-class-name\",\"children\":\"Process\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token maybe-class-name\",\"children\":\"Queue\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" current_process\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"class\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":\"WriteProcess\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token maybe-class-name\",\"children\":\"Process\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\" 写入的进程 \\\"\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"\\\"\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    def \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"__init__\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"self\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" queue\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],\"args\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"**\"}],\"kwargs\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        self\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":\"queue\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" queue\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"super\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"__init__\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],\"args\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"**\"}],\"kwargs\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    def \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"run\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"self\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        ls \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"[\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"            \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'第1行内容'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"            \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'第2行内容'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"            \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'第3行内容'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"            \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'第4行内容'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"            \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'第5行内容'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"]\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token keyword control-flow\",\"children\":\"for\"}],\" line \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"in\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token property literal-property\",\"children\":\"ls\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"            \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"print\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'进程名称: {}, 写入内容: {}'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"format\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"current_process\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":\"name\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" line\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"            self\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":\"queue\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"put\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"line\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"            # 没写入一次，休息\",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"1\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"-\"}],\"3s\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"            time\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"sleep\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"random\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"randint\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"1\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"3\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"class\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":\"ReadProcess\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token maybe-class-name\",\"children\":\"Process\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\" 读取的进程 \\\"\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"\\\"\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    def \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"__init__\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"self\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" queue\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],\"args\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"**\"}],\"kwargs\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        self\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":\"queue\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" queue\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"super\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"__init__\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],\"args\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"**\"}],\"kwargs\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    def \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"run\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"self\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token keyword control-flow\",\"children\":\"while\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token property literal-property\",\"children\":\"True\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"            content \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" self\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":\"queue\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"get\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"            \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"print\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'进程名称: {}, 读取内容: {}'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"format\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"self\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":\"name\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" content\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword control-flow\",\"children\":\"if\"}],\" __name__ \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"==\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'__main__'\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"    # 通过Queue共享数据\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    q \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":[\"$\",\"span\",null,{\"className\":\"token maybe-class-name\",\"children\":\"Queue\"}]}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"    # 写入内容的进程\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    t_write \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":[\"$\",\"span\",null,{\"className\":\"token maybe-class-name\",\"children\":\"WriteProcess\"}]}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"q\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    t_write\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"start\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"    # 读取内容的进程\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    t_read \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":[\"$\",\"span\",null,{\"className\":\"token maybe-class-name\",\"children\":\"ReadProcess\"}]}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"q\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    t_read\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"start\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    t_write\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"join\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    # t_read\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"join\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    t_read\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"terminate\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}]]}]}],[\"$\",\"p\",null,{\"children\":[\"注意：进程类中的\",[\"$\",\"code\",null,{\"children\":\"self.name\"}],\"等价于\",[\"$\",\"code\",null,{\"children\":\"current_process().name\"}],\"。 5. 多进程中的锁\"]}],[\"$\",\"$L16\",null,{\"className\":\"language-js\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-js code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword module\",\"children\":\"import\"}],\" random\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword module\",\"children\":\"import\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token imports\",\"children\":\"time\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword module\",\"children\":\"from\"}],\" multiprocessing \",[\"$\",\"span\",null,{\"className\":\"token keyword module\",\"children\":\"import\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token maybe-class-name\",\"children\":\"Process\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token maybe-class-name\",\"children\":\"Lock\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"class\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":\"WriteProcess\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token maybe-class-name\",\"children\":\"Process\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\" 写入文件 \\\"\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"\\\"\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    lock \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":[\"$\",\"span\",null,{\"className\":\"token maybe-class-name\",\"children\":\"Lock\"}]}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    def \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"__init__\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"self\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" file_name\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" index\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],\"args\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"**\"}],\"kwargs\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        self\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":\"file_name\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" file_name\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        self\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":\"index\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" index\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"super\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"__init__\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],\"args\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"**\"}],\"kwargs\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    def \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"run\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"self\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"with\"}],\" self\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":\"lock\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"            \",[\"$\",\"span\",null,{\"className\":\"token keyword control-flow\",\"children\":\"for\"}],\" i \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"in\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"range\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"5\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"                \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"with\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"open\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"self\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":\"file_name\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'a+'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" encoding\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'utf-8'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword module\",\"children\":\"as\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token property literal-property\",\"children\":\"f\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"                    content \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'现在是: {}, pid为: {}, 进程序号为: {}\\\\n'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"format\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"                        self\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":\"name\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"                        self\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":\"pid\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"                        self\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":\"index\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"                    \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"                    f\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"write\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"content\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"                    time\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"sleep\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"random\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"randint\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"1\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"5\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"                    \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"print\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"content\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword control-flow\",\"children\":\"if\"}],\" __name__ \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"==\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'__main__'\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    file_name \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'test.txt'\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword control-flow\",\"children\":\"for\"}],\" i \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"in\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"range\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"5\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        p \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":[\"$\",\"span\",null,{\"className\":\"token maybe-class-name\",\"children\":\"WriteProcess\"}]}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"file_name\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" i\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        p\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"start\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}]]}]}],[\"$\",\"ol\",null,{\"start\":\"6\",\"children\":[[\"$\",\"li\",null,{\"children\":[[\"$\",\"code\",null,{\"children\":\"multiprocessing.RLock\"}],\" 我们使用\",[\"$\",\"code\",null,{\"children\":\"multiprocessing.Lock()\"}],\"来进行加锁。\",[\"$\",\"code\",null,{\"children\":\"multiprocessing\"}],\"中还提供了另外一个\",[\"$\",\"code\",null,{\"children\":\"multiprocessing.RLock()\"}],\"锁。在同一进程内，对\",[\"$\",\"code\",null,{\"children\":\"RLock\"}],\"进行多次\",[\"$\",\"code\",null,{\"children\":\"acquire()\"}],\"操作，程序不会阻塞。\"]}],[\"$\",\"li\",null,{\"children\":\"进程池\"}]]}],[\"$\",\"$L16\",null,{\"className\":\"language-js\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-js code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword module\",\"children\":\"import\"}],\" os\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword module\",\"children\":\"import\"}],\" random\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword module\",\"children\":\"import\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token imports\",\"children\":\"time\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword module\",\"children\":\"from\"}],\" multiprocessing \",[\"$\",\"span\",null,{\"className\":\"token keyword module\",\"children\":\"import\"}],\" current_process\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token maybe-class-name\",\"children\":\"Pool\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"def \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"run\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"file_name\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" index\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\" 进程任务 \\\"\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"\\\"\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"with\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"open\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"file_name\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'a+'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" encoding\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'utf-8'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword module\",\"children\":\"as\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token property literal-property\",\"children\":\"f\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        now_process \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"current_process\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        content \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'{} - {} - {} \\\\n'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"format\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"            now_process\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":\"name\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"            now_process\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":\"pid\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"            index\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        f\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"write\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"content\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        time\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"sleep\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"random\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"randint\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"1\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"3\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"print\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"content\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token keyword control-flow\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'OK'\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword control-flow\",\"children\":\"if\"}],\" __name__ \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"==\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'__main__'\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    # \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"print\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"os\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"cpu_count\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"  # \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"4\"}],\"核\",[\"$\",\"span\",null,{\"className\":\"token constant\",\"children\":\"CPU\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    file_name \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'test_pool.txt'\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    pool \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":[\"$\",\"span\",null,{\"className\":\"token maybe-class-name\",\"children\":\"Pool\"}]}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"2\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"  # 创建有两个进程的进程池\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword control-flow\",\"children\":\"for\"}],\" i \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"in\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"range\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"20\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"        # 同步添加任务\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        # rest \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" pool\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"apply\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"run\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" args\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"file_name\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" i\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"        # 异步添加任务\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        rest \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" pool\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"apply_async\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"run\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" args\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"file_name\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" i\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"print\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'{} {}'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"format\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"i\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" rest\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    pool\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"close\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"  # 关闭进程池\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    pool\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"join\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}]]}]}],[\"$\",\"p\",null,{\"children\":\"注释：异步添加任务，不能保证任务的执行顺序。同步添加任务，可以保证任务的执行顺序。\"}],[\"$\",\"h2\",null,{\"className\":\"content-header\",\"id\":\"24-协程\",\"children\":[[\"$\",\"a\",null,{\"className\":\"break-words\",\"href\":\"#24-协程\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"2.4 协程\"]}],[\"$\",\"ol\",null,{\"children\":[[\"$\",\"li\",null,{\"children\":\"协程介绍 协程就是协同多任务。 协程在一个进程或者是一个线程中执行。 协程不需要锁机制。\"}],[\"$\",\"li\",null,{\"children\":[[\"$\",\"code\",null,{\"children\":\"yield\"}],\"生成器\"]}]]}],[\"$\",\"$L16\",null,{\"className\":\"language-js\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-js code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"def \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"count_down\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"n\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\" 倒计时效果 \\\"\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"\\\"\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword control-flow\",\"children\":\"while\"}],\" n \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u003e\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"0\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token keyword control-flow\",\"children\":\"yield\"}],\" n\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        n \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"-=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"1\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword control-flow\",\"children\":\"if\"}],\" __name__ \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"==\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'__main__'\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    rest \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"count_down\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"5\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"print\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"next\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"rest\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"  # \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"5\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"print\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"next\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"rest\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"  # \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"4\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"print\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"next\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"rest\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"  # \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"3\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"print\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"next\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"rest\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"  # \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"2\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"print\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"next\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"rest\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"  # \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"1\"}],\"\\n\"]}]]}]}],[\"$\",\"ol\",null,{\"start\":\"3\",\"children\":[\"$\",\"li\",null,{\"children\":[[\"$\",\"code\",null,{\"children\":\"Python3.5\"}],\"以前协程实现 使用生成器(\",[\"$\",\"code\",null,{\"children\":\"yield\"}],\")实现\"]}]}],[\"$\",\"$L16\",null,{\"className\":\"language-js\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-js code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"def \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"yield_test\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\" 实现协程函数 \\\"\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"\\\"\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword control-flow\",\"children\":\"while\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token property literal-property\",\"children\":\"True\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        n \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token keyword control-flow\",\"children\":\"yield\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"print\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"n\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword control-flow\",\"children\":\"if\"}],\" __name__ \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"==\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'__main__'\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    rest \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"yield_test\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"next\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"rest\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    rest\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"send\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'1'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"  # \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"1\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    rest\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"send\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'2'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"  # \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"2\"}],\"\\n\"]}]]}]}],[\"$\",\"ol\",null,{\"start\":\"4\",\"children\":[\"$\",\"li\",null,{\"children\":[[\"$\",\"code\",null,{\"children\":\"Python3.5\"}],\"以后协程实现 使用\",[\"$\",\"code\",null,{\"children\":\"async\"}],\"和\",[\"$\",\"code\",null,{\"children\":\"await\"}],\"关键字实现\"]}]}],[\"$\",\"$L16\",null,{\"className\":\"language-js\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-js code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword module\",\"children\":\"import\"}],\" asyncio\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"async\"}],\" def \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"do_sth\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"x\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"print\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"等待中: {}\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"format\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"x\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword control-flow\",\"children\":\"await\"}],\" asyncio\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"sleep\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"x\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"# 判断是否是协程函数\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"print\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"asyncio\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"iscoroutinefunction\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token parameter\",\"children\":\"do_sth\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"  # \",[\"$\",\"span\",null,{\"className\":\"token maybe-class-name\",\"children\":\"True\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"# 创建任务\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"coroutine \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"do_sth\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"5\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"# 创建事件循环队列\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"loop \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" asyncio\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"get_event_loop\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"# 注册任务\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"task \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" loop\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"create_task\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"coroutine\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"print\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"task\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"  # \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"className\":\"token maybe-class-name\",\"children\":\"Task\"}],\" pending coro\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"do_sth\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" running at \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"/\"}],[\"$\",\"span\",null,{\"className\":\"token maybe-class-name\",\"children\":\"Users\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"/\"}],\"nimengwei\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"/\"}],[\"$\",\"span\",null,{\"className\":\"token maybe-class-name\",\"children\":\"Code\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"/\"}],\"mycode\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"/\"}],\"python\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"/\"}],[\"$\",\"span\",null,{\"className\":\"token maybe-class-name\",\"children\":\"Python零基础入门\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"/\"}],[\"$\",\"span\",null,{\"className\":\"token maybe-class-name\",\"children\":\"Python基础知识\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"/\"}],\"chapter09\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"/\"}],\"async_test\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":\"py\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"4\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u003e\u003e\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"# 等待协程任务执行结束\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"loop\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"run_until_complete\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"task\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"print\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"task\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"  # \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"className\":\"token maybe-class-name\",\"children\":\"Task\"}],\" finished coro\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"do_sth\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" done\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" defined at \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"/\"}],[\"$\",\"span\",null,{\"className\":\"token maybe-class-name\",\"children\":\"Users\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"/\"}],\"nimengwei\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"/\"}],[\"$\",\"span\",null,{\"className\":\"token maybe-class-name\",\"children\":\"Code\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"/\"}],\"mycode\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"/\"}],\"python\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"/\"}],[\"$\",\"span\",null,{\"className\":\"token maybe-class-name\",\"children\":\"Python零基础入门\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"/\"}],[\"$\",\"span\",null,{\"className\":\"token maybe-class-name\",\"children\":\"Python基础知识\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"/\"}],\"chapter09\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"/\"}],\"async_test\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":\"py\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"4\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u003e\"}],\" result\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],[\"$\",\"span\",null,{\"className\":\"token maybe-class-name\",\"children\":\"None\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u003e\"}],\"\\n\"]}]]}]}],[\"$\",\"p\",null,{\"children\":[\"注意：必须使用\",[\"$\",\"code\",null,{\"children\":\"asyncio.sleep()\"}],\"，不能使用\",[\"$\",\"code\",null,{\"children\":\"time.sleep()\"}],\"。只有前者能返回一个协程对象。 5. 协程通信之嵌套调用\"]}],[\"$\",\"$L16\",null,{\"className\":\"language-js\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-js code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword module\",\"children\":\"import\"}],\" asyncio\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"async\"}],\" def \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"compute\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"x\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" y\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword control-flow\",\"children\":\"await\"}],\" asyncio\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"sleep\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"1\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword control-flow\",\"children\":\"return\"}],\" x \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"+\"}],\" y\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"async\"}],\" def \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"get_sum\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"x\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" y\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    rest \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword control-flow\",\"children\":\"await\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"compute\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"x\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" y\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"print\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"计算{} + {} = {}\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"format\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"x\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" y\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" rest\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"loop \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" asyncio\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"get_event_loop\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"# loop\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"run_until_complete\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"loop\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"create_task\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"get_sum\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"1\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"2\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"loop\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"run_until_complete\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"get_sum\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"1\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"2\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"loop\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"close\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}]]}]}],[\"$\",\"ol\",null,{\"start\":\"6\",\"children\":[\"$\",\"li\",null,{\"children\":\"协程通信之队列\"}]}],[\"$\",\"$L16\",null,{\"className\":\"language-js\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-js code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword module\",\"children\":\"import\"}],\" asyncio\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword module\",\"children\":\"import\"}],\" random\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"async\"}],\" def \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"add\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"store\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\" 写入数据到队列 \\\"\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"\\\"\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword control-flow\",\"children\":\"for\"}],\" i \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"in\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"range\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"5\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token keyword control-flow\",\"children\":\"await\"}],\" asyncio\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"sleep\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"random\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"randint\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"1\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"3\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token keyword control-flow\",\"children\":\"await\"}],\" store\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"put\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"i\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"print\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'add {}, queue size: {}'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"format\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"i\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" store\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"qsize\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"async\"}],\" def \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"reduce\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"store\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\" 从队列中删除数据 \\\"\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"\\\"\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword control-flow\",\"children\":\"for\"}],\" i \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"in\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"range\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"10\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        rest \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword control-flow\",\"children\":\"await\"}],\" store\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"get\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"print\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'reduce {}, queue size: {}'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"format\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"rest\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" store\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"qsize\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword control-flow\",\"children\":\"if\"}],\" __name__ \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"==\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'__main__'\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"    # 准备一个队列\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    store \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" asyncio\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":[\"$\",\"span\",null,{\"className\":\"token maybe-class-name\",\"children\":\"Queue\"}]}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"maxsize\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"5\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    a1 \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"add\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"store\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    a2 \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"add\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"store\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    r1 \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"reduce\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"store\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"    # 添加到事件队列\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    loop \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" asyncio\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"get_event_loop\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    loop\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"run_until_complete\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"asyncio\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"gather\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"a1\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" a2\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" r1\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    loop\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function property-access method\",\"children\":\"close\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}]]}]}]]}],[\"$\",\"div\",null,{\"className\":\"pt-6 pb-6 text-sm text-gray-700 dark:text-gray-300\",\"children\":[[\"$\",\"a\",null,{\"className\":\"break-words\",\"target\":\"_blank\",\"rel\":\"nofollow\",\"href\":\"https://mobile.twitter.com/search?q=https%3A%2F%2Fnmwei.github.io%2Fblog%2FPython%2FPython%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8---%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86%E4%B8%8E%E5%A4%9A%E7%BA%BF%E7%A8%8B\",\"children\":\"Discuss on Twitter\"}],\" • \",[\"$\",\"a\",null,{\"className\":\"break-words\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://github.com/nmwei/nmwei.github.io/blob/main/data/blog/Python/Python基础入门---内存管理与多线程.mdx\",\"children\":\"View on GitHub\"}]]}],[\"$\",\"div\",null,{\"className\":\"pt-6 pb-6 text-center text-gray-700 dark:text-gray-300\",\"id\":\"comment\",\"children\":[\"$\",\"$L17\",null,{\"slug\":\"Python/Python基础入门---内存管理与多线程\"}]}]]}],[\"$\",\"footer\",null,{\"children\":[[\"$\",\"div\",null,{\"className\":\"divide-gray-200 text-sm leading-5 font-medium xl:col-start-1 xl:row-start-2 xl:divide-y dark:divide-gray-700\",\"children\":[[\"$\",\"div\",null,{\"className\":\"py-4 xl:py-8\",\"children\":[[\"$\",\"h2\",null,{\"className\":\"text-xs tracking-wide text-gray-500 uppercase dark:text-gray-400\",\"children\":\"Tags\"}],[\"$\",\"div\",null,{\"className\":\"flex flex-wrap\",\"children\":[[\"$\",\"$L5\",\"Python\",{\"href\":\"/tags/python\",\"className\":\"text-primary-500 hover:text-primary-600 dark:hover:text-primary-400 mr-3 text-sm font-medium\",\"children\":\"Python\"}],[\"$\",\"$L5\",\"后端\",{\"href\":\"/tags/后端\",\"className\":\"text-primary-500 hover:text-primary-600 dark:hover:text-primary-400 mr-3 text-sm font-medium\",\"children\":\"后端\"}]]}]]}],[\"$\",\"div\",null,{\"className\":\"flex justify-between py-4 xl:block xl:space-y-8 xl:py-8\",\"children\":[[\"$\",\"div\",null,{\"children\":[[\"$\",\"h2\",null,{\"className\":\"text-xs tracking-wide text-gray-500 uppercase dark:text-gray-400\",\"children\":\"Previous Article\"}],[\"$\",\"div\",null,{\"className\":\"text-primary-500 hover:text-primary-600 dark:hover:text-primary-400\",\"children\":[\"$\",\"$L5\",null,{\"className\":\"break-words\",\"href\":\"/blog/Python/Python基础入门---正则表达式与综合实战\",\"children\":\"Python基础入门---正则表达式与综合实战\"}]}]]}],[\"$\",\"div\",null,{\"children\":[[\"$\",\"h2\",null,{\"className\":\"text-xs tracking-wide text-gray-500 uppercase dark:text-gray-400\",\"children\":\"Next Article\"}],[\"$\",\"div\",null,{\"className\":\"text-primary-500 hover:text-primary-600 dark:hover:text-primary-400\",\"children\":[\"$\",\"$L5\",null,{\"className\":\"break-words\",\"href\":\"/blog/Python/Python操作三大数据库---MySQL数据库(Part2)\",\"children\":\"Python操作三大数据库---MySQL数据库(Part2)\"}]}]]}]]}]]}],[\"$\",\"div\",null,{\"className\":\"pt-4 xl:pt-8\",\"children\":[\"$\",\"$L5\",null,{\"className\":\"text-primary-500 hover:text-primary-600 dark:hover:text-primary-400\",\"href\":\"/blog\",\"aria-label\":\"Back to the blog\",\"children\":\"← Back to the blog\"}]}]]}]]}]]}]}]]}]]\n"])</script><script>self.__next_f.push([1,"10:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"meta\",\"1\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\nd:null\n"])</script><script>self.__next_f.push([1,"e:null\n"])</script><script>self.__next_f.push([1,"12:[[\"$\",\"title\",\"0\",{\"children\":\"Python基础入门---内存管理与多线程 | 我的博客\"}],[\"$\",\"meta\",\"1\",{\"name\":\"description\",\"content\":\"Python基础入门---内存管理与多线程相关文章\"}],[\"$\",\"meta\",\"2\",{\"name\":\"robots\",\"content\":\"index, follow\"}],[\"$\",\"meta\",\"3\",{\"name\":\"googlebot\",\"content\":\"index, follow, max-video-preview:-1, max-image-preview:large, max-snippet:-1\"}],[\"$\",\"link\",\"4\",{\"rel\":\"canonical\",\"href\":\"https://nmwei.github.io/blog/Python/Python%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8---%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86%E4%B8%8E%E5%A4%9A%E7%BA%BF%E7%A8%8B\"}],[\"$\",\"link\",\"5\",{\"rel\":\"alternate\",\"type\":\"application/rss+xml\",\"href\":\"https://nmwei.github.io/feed.xml\"}],[\"$\",\"meta\",\"6\",{\"property\":\"og:title\",\"content\":\"Python基础入门---内存管理与多线程\"}],[\"$\",\"meta\",\"7\",{\"property\":\"og:description\",\"content\":\"Python基础入门---内存管理与多线程相关文章\"}],[\"$\",\"meta\",\"8\",{\"property\":\"og:url\",\"content\":\"https://nmwei.github.io/blog/Python/Python%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8---%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86%E4%B8%8E%E5%A4%9A%E7%BA%BF%E7%A8%8B\"}],[\"$\",\"meta\",\"9\",{\"property\":\"og:site_name\",\"content\":\"我的博客\"}],[\"$\",\"meta\",\"10\",{\"property\":\"og:locale\",\"content\":\"en_US\"}],[\"$\",\"meta\",\"11\",{\"property\":\"og:image\",\"content\":\"https://nmwei.github.io/static/images/python.jpg\"}],[\"$\",\"meta\",\"12\",{\"property\":\"og:type\",\"content\":\"article\"}],[\"$\",\"meta\",\"13\",{\"property\":\"article:published_time\",\"content\":\"2019-10-17T00:00:00.000Z\"}],[\"$\",\"meta\",\"14\",{\"property\":\"article:modified_time\",\"content\":\"2019-10-17T00:00:00.000Z\"}],[\"$\",\"meta\",\"15\",{\"property\":\"article:author\",\"content\":\"倪梦威\"}],[\"$\",\"meta\",\"16\",{\"name\":\"twitter:card\",\"content\":\"summary_large_image\"}],[\"$\",\"meta\",\"17\",{\"name\":\"twitter:title\",\"content\":\"Python基础入门---内存管理与多线程\"}],[\"$\",\"meta\",\"18\",{\"name\":\"twitter:description\",\"content\":\"Python基础入门---内存管理与多线程相关文章\"}],[\"$\",\"meta\",\"19\",{\"name\":\"twitter:image\",\"content\":\"https://nmwei.github.io/static/images/python.jpg\"}]]\n"])</script></body></html>